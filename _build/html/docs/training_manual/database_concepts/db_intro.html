<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>15.1. Lesson: Introduction to Databases &mdash; QGIS Documentation  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/qgis_docs.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/qgis_topbar.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/qgis_logo.ico"/>
    <link rel="canonical" href="https://docs.qgis.org/latest/en/docs/training_manual/database_concepts/db_intro.html"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="15.2. Lesson: Implementing the Data Model" href="data_model.html" />
    <link rel="prev" title="15. Module: Database Concepts with PostgreSQL" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

  <nav class="release_status_topbar">
    <div class="row isTesting">
     This documentation is a work in progress. For the Long Term Release and translations, please visit the <a href="https://docs.qgis.org/latest/en/docs/training_manual/database_concepts/db_intro.html">latest version</a>.
    </div>
  </nav>

   

 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
   
            <a href="../../index.html" class="icon icon-home"> QGIS Documentation
            <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                testing
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
   <a href= "../../../genindex.html">Index</a>
 
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">For Wageningen Students</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../land_degradation_development/index.html">Land Degradation and Development</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Users</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../user_manual/index.html">QGIS Desktop User Guide/Manual (QGIS Testing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../server_manual/index.html">QGIS Server Guide/Manual (QGIS Testing)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Training Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../foreword/index.html">1. Course Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic_map/index.html">2. Module: Creating and Exploring a Basic Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vector_classification/index.html">3. Module: Classifying Vector Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../map_composer/index.html">4. Module: Laying out the Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../create_vector_data/index.html">5. Module: Creating Vector Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vector_analysis/index.html">6. Module: Vector Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rasters/index.html">7. Module: Rasters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../complete_analysis/index.html">8. Module: Completing the Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qgis_plugins/index.html">9. Module: Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../online_resources/index.html">10. Module: Online Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qgis_server/index.html">11. Module: QGIS Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../grass/index.html">12. Module: GRASS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assessment/index.html">13. Module: Assessment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../forestry/index.html">14. Module: Forestry Application</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">15. Module: Database Concepts with PostgreSQL</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">15.1. Lesson: Introduction to Databases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-is-a-database">15.1.1. What is a Database?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tables">15.1.2. Tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#columns-fields">15.1.3. Columns / Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="#records">15.1.4. Records</a></li>
<li class="toctree-l4"><a class="reference internal" href="#datatypes">15.1.5. Datatypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modelling-an-address-database">15.1.6. Modelling an Address Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="#database-theory">15.1.7. Database Theory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#normalisation">15.1.8. Normalisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">15.1.9. Try Yourself </a></li>
<li class="toctree-l4"><a class="reference internal" href="#indexes">15.1.10. Indexes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sequences">15.1.11. Sequences</a></li>
<li class="toctree-l4"><a class="reference internal" href="#entity-relationship-diagramming">15.1.12. Entity Relationship Diagramming</a></li>
<li class="toctree-l4"><a class="reference internal" href="#constraints-primary-keys-and-foreign-keys">15.1.13. Constraints, Primary Keys and Foreign Keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transactions">15.1.14. Transactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ic">15.1.15. In Conclusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wn">15.1.16. What’s Next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_model.html">15.2. Lesson: Implementing the Data Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="adding_data.html">15.3. Lesson: Adding Data to the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="queries.html">15.4. Lesson: Queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html">15.5. Lesson: Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="rules.html">15.6. Lesson: Rules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../spatial_databases/index.html">16. Module: Spatial Database Concepts with PostGIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing/index.html">17. The QGIS processing guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../databases/index.html">18. Module: Using Spatial Databases in QGIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/contribute.html">19. Appendix: Contributing To This Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/preparing_data.html">20. Preparing Exercise Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../gentle_gis_introduction/index.html">A Gentle Introduction to GIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Writers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation_guidelines/index.html">Documentation Guidelines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../pyqgis_developer_cookbook/index.html">PyQGIS Cookbook (QGIS Testing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers_guide/index.html">Developers Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QGIS Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">QGIS Training Manual</a> &raquo;</li>
          <li><a href="index.html"><span class="section-number">15. </span>Module: Database Concepts with PostgreSQL</a> &raquo;</li>
      <li><span class="section-number">15.1. </span>Lesson: Introduction to Databases</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/qgis/QGIS-Documentation/blob/master/docs/training_manual/database_concepts/db_intro.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="index.html" class="btn btn-neutral float-left" title="15. Module: Database Concepts with PostgreSQL" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="data_model.html" class="btn btn-neutral float-right" title="15.2. Lesson: Implementing the Data Model" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ls-introduction-to-databases">
<h1><span class="section-number">15.1. </span>Lesson: Introduction to Databases<a class="headerlink" href="#ls-introduction-to-databases" title="Permalink to this headline"></a></h1>
<p>Before using PostgreSQL, let’s make sure of our ground by covering general
database theory. You will not need to enter any of the example code; it’s only
there for illustration purposes.</p>
<p><strong>The goal for this lesson:</strong> To understand fundamental database concepts.</p>
<section id="what-is-a-database">
<h2><span class="section-number">15.1.1. </span>What is a Database?<a class="headerlink" href="#what-is-a-database" title="Permalink to this headline"></a></h2>
<p>A database consists of an organized collection of data for one or more uses,
typically in digital form. <em>- Wikipedia</em></p>
<p>A database management system (DBMS) consists of software that operates
databases, providing storage, access, security, backup and other facilities.
<em>- Wikipedia</em></p>
</section>
<section id="tables">
<h2><span class="section-number">15.1.2. </span>Tables<a class="headerlink" href="#tables" title="Permalink to this headline"></a></h2>
<p>In relational databases and flat file databases, a table is a set of data
elements (values) that is organized using a model of vertical columns (which
are identified by their name) and horizontal rows. A table has a specified
number of columns, but can have any number of rows. Each row is identified
by the values appearing in a particular column subset which has been
identified as a candidate key. <em>- Wikipedia</em></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span> <span class="n">id</span> <span class="o">|</span> <span class="n">name</span>  <span class="o">|</span> <span class="n">age</span>
<span class="c1">----+-------+-----</span>
  <span class="mi">1</span> <span class="o">|</span> <span class="n">Tim</span>   <span class="o">|</span>  <span class="mi">20</span>
  <span class="mi">2</span> <span class="o">|</span> <span class="n">Horst</span> <span class="o">|</span>  <span class="mi">88</span>
<span class="p">(</span><span class="mi">2</span> <span class="k">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>In SQL databases a table is also known as a <strong>relation.</strong></p>
</section>
<section id="columns-fields">
<h2><span class="section-number">15.1.3. </span>Columns / Fields<a class="headerlink" href="#columns-fields" title="Permalink to this headline"></a></h2>
<p>A column is a set of data values of a particular simple type, one for each
row of the table. The columns provide the structure according to which the
rows are composed. The term field is often used interchangeably with column,
although many consider it more correct to use field (or field value) to refer
specifically to the single item that exists at the intersection between one
row and one column. <em>- Wikipedia</em></p>
<p>A column:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">name</span>  <span class="o">|</span>
<span class="o">+</span><span class="c1">-------+</span>
<span class="o">|</span> <span class="n">Tim</span>   <span class="o">|</span>
<span class="o">|</span> <span class="n">Horst</span> <span class="o">|</span>
</pre></div>
</div>
<p>A field:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">Horst</span> <span class="o">|</span>
</pre></div>
</div>
</section>
<section id="records">
<h2><span class="section-number">15.1.4. </span>Records<a class="headerlink" href="#records" title="Permalink to this headline"></a></h2>
<p>A record is the information stored in a table row. Each record will have a
field for each of the columns in the table.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span> <span class="o">|</span> <span class="n">Horst</span> <span class="o">|</span>  <span class="mi">88</span>  <span class="o">&lt;</span><span class="c1">-- one record</span>
</pre></div>
</div>
</section>
<section id="datatypes">
<h2><span class="section-number">15.1.5. </span>Datatypes<a class="headerlink" href="#datatypes" title="Permalink to this headline"></a></h2>
<p>Datatypes restrict the kind of information that can be stored in a column.
<em>- Tim and Horst</em></p>
<p>There are many kinds of datatypes. Let’s focus on the most common:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">String</span></code> - to store free-form text data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Integer</span></code> - to store whole numbers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Real</span></code> - to store decimal numbers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Date</span></code> - to store Horst’s birthday so no one forgets</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Boolean</span></code> - to store simple true/false values</p></li>
</ul>
<p>You can tell the database to allow you to also store nothing in a field. If
there is nothing in a field, then the field content is referred to as a
<strong>‘null’ value</strong>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">insert</span> <span class="k">into</span> <span class="n">person</span> <span class="p">(</span><span class="n">age</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="mi">40</span><span class="p">);</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">person</span><span class="p">;</span>
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">id</span> <span class="o">|</span> <span class="n">name</span>  <span class="o">|</span> <span class="n">age</span>
<span class="c1">---+-------+-----</span>
 <span class="mi">1</span> <span class="o">|</span> <span class="n">Tim</span>   <span class="o">|</span>  <span class="mi">20</span>
 <span class="mi">2</span> <span class="o">|</span> <span class="n">Horst</span> <span class="o">|</span>  <span class="mi">88</span>
 <span class="mi">4</span> <span class="o">|</span>       <span class="o">|</span>  <span class="mi">40</span>  <span class="o">&lt;</span><span class="c1">-- null for name</span>
<span class="p">(</span><span class="mi">3</span> <span class="k">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>There are many more datatypes you can use - <a class="reference external" href="https://www.postgresql.org/docs/current/datatype.html">check the PostgreSQL manual!</a></p>
</section>
<section id="modelling-an-address-database">
<h2><span class="section-number">15.1.6. </span>Modelling an Address Database<a class="headerlink" href="#modelling-an-address-database" title="Permalink to this headline"></a></h2>
<p>Let’s use a simple case study to see how a database is constructed. We want to
create an address database.</p>
<section id="ty-basic">
<h3><span class="section-number">15.1.6.1. </span>Try Yourself <img alt="basic" src="../../../_images/basic.png" /><a class="headerlink" href="#ty-basic" title="Permalink to this headline"></a></h3>
<p>Write down the properties which make up a simple address and which we would want
to store in our database.</p>
<div class="dropdown admonition">
<p class="admonition-title">Answer</p>
<p>For our theoretical address table, we might want to store the following
properties:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">House</span> <span class="n">Number</span>
<span class="n">Street</span> <span class="n">Name</span>
<span class="n">Suburb</span> <span class="n">Name</span>
<span class="n">City</span> <span class="n">Name</span>
<span class="n">Postcode</span>
<span class="n">Country</span>
</pre></div>
</div>
<p>When creating the table to represent an address object, we would create columns
to represent each of these properties and we would name them with SQL-compliant
and possibly shortened names:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">house_number</span>
<span class="n">street_name</span>
<span class="n">suburb</span>
<span class="n">city</span>
<span class="n">postcode</span>
<span class="n">country</span>
</pre></div>
</div>
</div>
</section>
<section id="address-structure">
<h3><span class="section-number">15.1.6.2. </span>Address Structure<a class="headerlink" href="#address-structure" title="Permalink to this headline"></a></h3>
<p>The properties that describe an address are the columns. The type of
information stored in each column is its datatype. In the next section we will
analyse our conceptual address table to see how we can make it better!</p>
</section>
</section>
<section id="database-theory">
<h2><span class="section-number">15.1.7. </span>Database Theory<a class="headerlink" href="#database-theory" title="Permalink to this headline"></a></h2>
<p>The process of creating a database involves creating a model of the real world;
taking real world concepts and representing them in the database as entities.</p>
</section>
<section id="normalisation">
<h2><span class="section-number">15.1.8. </span>Normalisation<a class="headerlink" href="#normalisation" title="Permalink to this headline"></a></h2>
<p>One of the main ideas in a database is to avoid data duplication / redundancy.
The process of removing redundancy from a database is called Normalisation.</p>
<p>Normalization is a systematic way of ensuring that a database structure is
suitable for general-purpose querying and free of certain undesirable
characteristics - insertion, update, and deletion anomalies - that could lead
to a loss of data integrity. <em>- Wikipedia</em></p>
<p>There are different kinds of normalisation ‘forms’.</p>
<p>Let’s take a look at a simple example:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">Table</span> <span class="ss">&quot;public.people&quot;</span>

<span class="k">Column</span>    <span class="o">|</span>          <span class="k">Type</span>          <span class="o">|</span>                <span class="n">Modifiers</span>
<span class="c1">----------+------------------------+------------------------------------</span>
 <span class="n">id</span>       <span class="o">|</span> <span class="nb">integer</span>                <span class="o">|</span> <span class="k">not</span> <span class="k">null</span> <span class="k">default</span>
          <span class="o">|</span>                        <span class="o">|</span> <span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;people_id_seq&#39;</span><span class="p">::</span><span class="n">regclass</span><span class="p">)</span>
          <span class="o">|</span>                        <span class="o">|</span>
 <span class="n">name</span>     <span class="o">|</span> <span class="nb">character</span> <span class="nb">varying</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>  <span class="o">|</span>
 <span class="n">address</span>  <span class="o">|</span> <span class="nb">character</span> <span class="nb">varying</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span> <span class="o">|</span> <span class="k">not</span> <span class="k">null</span>
 <span class="n">phone_no</span> <span class="o">|</span> <span class="nb">character</span> <span class="nb">varying</span>      <span class="o">|</span>
<span class="n">Indexes</span><span class="p">:</span>
 <span class="ss">&quot;people_pkey&quot;</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span> <span class="n">btree</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">people</span><span class="p">;</span>

<span class="n">id</span> <span class="o">|</span>     <span class="n">name</span>      <span class="o">|</span>           <span class="n">address</span>           <span class="o">|</span>  <span class="n">phone_no</span>
<span class="c1">---+---------------+-----------------------------+-------------</span>
 <span class="mi">1</span> <span class="o">|</span> <span class="n">Tim</span> <span class="n">Sutton</span>    <span class="o">|</span> <span class="mi">3</span> <span class="n">Buirski</span> <span class="n">Plein</span><span class="p">,</span> <span class="n">Swellendam</span> <span class="o">|</span> <span class="mi">071</span> <span class="mi">123</span> <span class="mi">123</span>
 <span class="mi">2</span> <span class="o">|</span> <span class="n">Horst</span> <span class="n">Duester</span> <span class="o">|</span> <span class="mi">4</span> <span class="n">Avenue</span> <span class="n">du</span> <span class="n">Roix</span><span class="p">,</span> <span class="n">Geneva</span>    <span class="o">|</span> <span class="mi">072</span> <span class="mi">121</span> <span class="mi">122</span>
<span class="p">(</span><span class="mi">2</span> <span class="k">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>Imagine you have many friends with the same street name or city. Every time
this data is duplicated, it consumes space. Worse still, if a city name
changes, you have to do a lot of work to update your database.</p>
</section>
<section id="id1">
<h2><span class="section-number">15.1.9. </span>Try Yourself <img alt="basic" src="../../../_images/basic.png" /><a class="headerlink" href="#id1" title="Permalink to this headline"></a></h2>
<p>Redesign the theoretical <cite>people</cite> table above to reduce duplication and to
normalise the data structure.</p>
<p>You can read more about database normalisation <a class="reference external" href="https://en.wikipedia.org/wiki/Database_normalization">here</a></p>
<div class="dropdown admonition">
<p class="admonition-title">Answer</p>
<p>The major problem with the <em>people</em> table is that there is a single address
field which contains a person’s entire address. Thinking about our theoretical
<em>address</em> table earlier in this lesson, we know that an address is made up of
many different properties. By storing all these properties in one field, we make
it much harder to update and query our data. We therefore need to split the
address field into the various properties. This would give us a table which has
the following structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span> <span class="o">|</span>     <span class="n">name</span>      <span class="o">|</span> <span class="n">house_no</span> <span class="o">|</span>  <span class="n">street_name</span>   <span class="o">|</span>    <span class="n">city</span>    <span class="o">|</span>   <span class="n">phone_no</span>
 <span class="o">--+---------------+----------+----------------+------------+-----------------</span>
 <span class="mi">1</span> <span class="o">|</span> <span class="n">Tim</span> <span class="n">Sutton</span>    <span class="o">|</span>     <span class="mi">3</span>    <span class="o">|</span> <span class="n">Buirski</span> <span class="n">Plein</span>  <span class="o">|</span> <span class="n">Swellendam</span> <span class="o">|</span> <span class="mi">071</span> <span class="mi">123</span> <span class="mi">123</span>
 <span class="mi">2</span> <span class="o">|</span> <span class="n">Horst</span> <span class="n">Duester</span> <span class="o">|</span>     <span class="mi">4</span>    <span class="o">|</span> <span class="n">Avenue</span> <span class="n">du</span> <span class="n">Roix</span> <span class="o">|</span> <span class="n">Geneva</span>     <span class="o">|</span> <span class="mi">072</span> <span class="mi">121</span> <span class="mi">122</span>
</pre></div>
</div>
<p>In the next section, you will learn about Foreign Key relationships which could
be used in this example to further improve our database’s structure.</p>
</div>
</section>
<section id="indexes">
<h2><span class="section-number">15.1.10. </span>Indexes<a class="headerlink" href="#indexes" title="Permalink to this headline"></a></h2>
<p>A database index is a data structure that improves the speed of data
retrieval operations on a database table. <em>- Wikipedia</em></p>
<p>Imagine you are reading a textbook and looking for the explanation of a concept
- and the textbook has no index! You will have to start reading at one cover
and work your way through the entire book until you find the information you
need. The index at the back of a book helps you to jump quickly to the page
with the relevant information:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">create</span> <span class="k">index</span> <span class="n">person_name_idx</span> <span class="k">on</span> <span class="n">people</span> <span class="p">(</span><span class="n">name</span><span class="p">);</span>
</pre></div>
</div>
<p>Now searches on name will be faster:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">Table</span> <span class="ss">&quot;public.people&quot;</span>

<span class="k">Column</span>   <span class="o">|</span>          <span class="k">Type</span>          <span class="o">|</span>               <span class="n">Modifiers</span>
<span class="c1">----------+------------------------+-------------------------------------</span>
 <span class="n">id</span>       <span class="o">|</span> <span class="nb">integer</span>                <span class="o">|</span> <span class="k">not</span> <span class="k">null</span> <span class="k">default</span>
          <span class="o">|</span>                        <span class="o">|</span> <span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;people_id_seq&#39;</span><span class="p">::</span><span class="n">regclass</span><span class="p">)</span>
          <span class="o">|</span>                        <span class="o">|</span>
 <span class="n">name</span>     <span class="o">|</span> <span class="nb">character</span> <span class="nb">varying</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>  <span class="o">|</span>
 <span class="n">address</span>  <span class="o">|</span> <span class="nb">character</span> <span class="nb">varying</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span> <span class="o">|</span> <span class="k">not</span> <span class="k">null</span>
 <span class="n">phone_no</span> <span class="o">|</span> <span class="nb">character</span> <span class="nb">varying</span>      <span class="o">|</span>
<span class="n">Indexes</span><span class="p">:</span>
 <span class="ss">&quot;people_pkey&quot;</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span> <span class="n">btree</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
 <span class="ss">&quot;person_name_idx&quot;</span> <span class="n">btree</span> <span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sequences">
<h2><span class="section-number">15.1.11. </span>Sequences<a class="headerlink" href="#sequences" title="Permalink to this headline"></a></h2>
<p>A sequence is a unique number generator. It is normally used to create a unique
identifier for a column in a table.</p>
<p>In this example, id is a sequence - the number is incremented each time a
record is added to the table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">id</span> <span class="o">|</span>     <span class="n">name</span>     <span class="o">|</span>           <span class="n">address</span>           <span class="o">|</span>  <span class="n">phone_no</span>
<span class="c1">---+--------------+-----------------------------+-------------</span>
 <span class="mi">1</span> <span class="o">|</span> <span class="n">Tim</span> <span class="n">Sutton</span>   <span class="o">|</span> <span class="mi">3</span> <span class="n">Buirski</span> <span class="n">Plein</span><span class="p">,</span> <span class="n">Swellendam</span> <span class="o">|</span> <span class="mi">071</span> <span class="mi">123</span> <span class="mi">123</span>
 <span class="mi">2</span> <span class="o">|</span> <span class="n">Horst</span> <span class="n">Duster</span> <span class="o">|</span> <span class="mi">4</span> <span class="n">Avenue</span> <span class="n">du</span> <span class="n">Roix</span><span class="p">,</span> <span class="n">Geneva</span>    <span class="o">|</span> <span class="mi">072</span> <span class="mi">121</span> <span class="mi">122</span>
</pre></div>
</div>
</section>
<section id="entity-relationship-diagramming">
<h2><span class="section-number">15.1.12. </span>Entity Relationship Diagramming<a class="headerlink" href="#entity-relationship-diagramming" title="Permalink to this headline"></a></h2>
<p>In a normalised database, you typically have many relations (tables). The
entity-relationship diagram (ER Diagram) is used to design the logical
dependencies between the relations. Consider our non-normalised <cite>people</cite> table
from earlier in the lesson:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">people</span><span class="p">;</span>

 <span class="n">id</span> <span class="o">|</span>     <span class="n">name</span>     <span class="o">|</span>           <span class="n">address</span>           <span class="o">|</span>  <span class="n">phone_no</span>
<span class="c1">----+--------------+-----------------------------+-------------</span>
 <span class="mi">1</span>  <span class="o">|</span> <span class="n">Tim</span> <span class="n">Sutton</span>   <span class="o">|</span> <span class="mi">3</span> <span class="n">Buirski</span> <span class="n">Plein</span><span class="p">,</span> <span class="n">Swellendam</span> <span class="o">|</span> <span class="mi">071</span> <span class="mi">123</span> <span class="mi">123</span>
 <span class="mi">2</span>  <span class="o">|</span> <span class="n">Horst</span> <span class="n">Duster</span> <span class="o">|</span> <span class="mi">4</span> <span class="n">Avenue</span> <span class="n">du</span> <span class="n">Roix</span><span class="p">,</span> <span class="n">Geneva</span>    <span class="o">|</span> <span class="mi">072</span> <span class="mi">121</span> <span class="mi">122</span>
<span class="p">(</span><span class="mi">2</span> <span class="k">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>With a little work we can split it into two tables, removing the need to repeat
the street name for individuals who live in the same street:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">streets</span><span class="p">;</span>

 <span class="n">id</span> <span class="o">|</span>     <span class="n">name</span>
<span class="c1">----+--------------</span>
 <span class="mi">1</span>  <span class="o">|</span> <span class="n">Plein</span> <span class="n">Street</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>
</pre></div>
</div>
<p>and:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">people</span><span class="p">;</span>

 <span class="n">id</span> <span class="o">|</span>     <span class="n">name</span>     <span class="o">|</span> <span class="n">house_no</span> <span class="o">|</span> <span class="n">street_id</span> <span class="o">|</span>  <span class="n">phone_no</span>
<span class="c1">----+--------------+----------+-----------+-------------</span>
  <span class="mi">1</span> <span class="o">|</span> <span class="n">Horst</span> <span class="n">Duster</span> <span class="o">|</span>        <span class="mi">4</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span> <span class="mi">072</span> <span class="mi">121</span> <span class="mi">122</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>
</pre></div>
</div>
<p>We can then link the two tables using the ‘keys’ <kbd class="kbd docutils literal notranslate">streets.id</kbd> and
<kbd class="kbd docutils literal notranslate">people.streets_id</kbd>.</p>
<p>If we draw an ER Diagram for these two tables it would look something like
this:</p>
<figure class="align-center">
<img alt="../../../_images/er-people-streets.png" src="../../../_images/er-people-streets.png" />
</figure>
<p>The ER Diagram helps us to express ‘one to many’ relationships. In this case
the arrow symbol show that one street can have many people living on it.</p>
<section id="ty-moderate">
<h3><span class="section-number">15.1.12.1. </span>Try Yourself <img alt="moderate" src="../../../_images/moderate.png" /><a class="headerlink" href="#ty-moderate" title="Permalink to this headline"></a></h3>
<p>Our <cite>people</cite> model still has some normalisation issues - try to see if you can
normalise it further and show your thoughts by means of an ER Diagram.</p>
<div class="dropdown admonition">
<p class="admonition-title">Answer</p>
<p>Our <em>people</em> table currently looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span> <span class="o">|</span>     <span class="n">name</span>     <span class="o">|</span> <span class="n">house_no</span> <span class="o">|</span> <span class="n">street_id</span> <span class="o">|</span>  <span class="n">phone_no</span>
<span class="o">---+--------------+----------+-----------+-------------</span>
 <span class="mi">1</span> <span class="o">|</span> <span class="n">Horst</span> <span class="n">Duster</span> <span class="o">|</span>        <span class="mi">4</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span> <span class="mi">072</span> <span class="mi">121</span> <span class="mi">122</span>
</pre></div>
</div>
<p>The <span class="guilabel">street_id</span> column represents a ‘one to many’ relationship between the
people object and the related street object, which is in the <em>streets</em> table.</p>
<p>One way to further normalise the table is to split the name field into
<em>first_name</em> and <em>last_name</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span> <span class="o">|</span> <span class="n">first_name</span> <span class="o">|</span> <span class="n">last_name</span>  <span class="o">|</span> <span class="n">house_no</span> <span class="o">|</span> <span class="n">street_id</span> <span class="o">|</span>  <span class="n">phone_no</span>
<span class="o">---+------------+------------+----------+-----------+------------</span>
 <span class="mi">1</span> <span class="o">|</span>    <span class="n">Horst</span>   <span class="o">|</span>   <span class="n">Duster</span>   <span class="o">|</span>     <span class="mi">4</span>    <span class="o">|</span>     <span class="mi">1</span>     <span class="o">|</span> <span class="mi">072</span> <span class="mi">121</span> <span class="mi">122</span>
</pre></div>
</div>
<p>We can also create separate tables for the town or city name and country,
linking them to our <em>people</em> table via ‘one to many’ relationships:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span> <span class="o">|</span> <span class="n">first_name</span> <span class="o">|</span> <span class="n">last_name</span> <span class="o">|</span> <span class="n">house_no</span> <span class="o">|</span> <span class="n">street_id</span> <span class="o">|</span> <span class="n">town_id</span> <span class="o">|</span> <span class="n">country_id</span>
<span class="o">---+------------+-----------+----------+-----------+---------+------------</span>
 <span class="mi">1</span> <span class="o">|</span>    <span class="n">Horst</span>   <span class="o">|</span>   <span class="n">Duster</span>  <span class="o">|</span>     <span class="mi">4</span>    <span class="o">|</span>     <span class="mi">1</span>     <span class="o">|</span>    <span class="mi">2</span>    <span class="o">|</span>     <span class="mi">1</span>
</pre></div>
</div>
<p>An ER Diagram to represent this would look like this:</p>
<figure class="align-center">
<img alt="../../../_images/er-people-normalised-example.png" src="../../../_images/er-people-normalised-example.png" />
</figure>
</div>
</section>
</section>
<section id="constraints-primary-keys-and-foreign-keys">
<h2><span class="section-number">15.1.13. </span>Constraints, Primary Keys and Foreign Keys<a class="headerlink" href="#constraints-primary-keys-and-foreign-keys" title="Permalink to this headline"></a></h2>
<p>A database constraint is used to ensure that data in a relation matches the
modeller’s view of how that data should be stored. For example a constraint on
your postal code could ensure that the number falls between <kbd class="kbd docutils literal notranslate">1000</kbd> and
<kbd class="kbd docutils literal notranslate">9999</kbd>.</p>
<p>A Primary key is one or more field values that make a record unique. Usually
the primary key is called id and is a sequence.</p>
<p>A Foreign key is used to refer to a unique record on another table (using that
other table’s primary key).</p>
<p>In ER Diagramming, the linkage between tables is normally based on Foreign keys
linking to Primary keys.</p>
<p>If we look at our people example, the table definition shows that the street
column is a foreign key that references the primary key on the streets table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">Table</span> <span class="ss">&quot;public.people&quot;</span>

 <span class="k">Column</span>    <span class="o">|</span>         <span class="k">Type</span>          <span class="o">|</span>  <span class="n">Modifiers</span>
<span class="c1">-----------+-----------------------+--------------------------------------</span>
 <span class="n">id</span>        <span class="o">|</span> <span class="nb">integer</span>               <span class="o">|</span> <span class="k">not</span> <span class="k">null</span> <span class="k">default</span>
           <span class="o">|</span>                       <span class="o">|</span> <span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;people_id_seq&#39;</span><span class="p">::</span><span class="n">regclass</span><span class="p">)</span>
 <span class="n">name</span>      <span class="o">|</span> <span class="nb">character</span> <span class="nb">varying</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="o">|</span>
 <span class="n">house_no</span>  <span class="o">|</span> <span class="nb">integer</span>               <span class="o">|</span> <span class="k">not</span> <span class="k">null</span>
 <span class="n">street_id</span> <span class="o">|</span> <span class="nb">integer</span>               <span class="o">|</span> <span class="k">not</span> <span class="k">null</span>
 <span class="n">phone_no</span>  <span class="o">|</span> <span class="nb">character</span> <span class="nb">varying</span>     <span class="o">|</span>
<span class="n">Indexes</span><span class="p">:</span>
<span class="ss">&quot;people_pkey&quot;</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span> <span class="n">btree</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="k">Foreign</span><span class="o">-</span><span class="k">key</span> <span class="k">constraints</span><span class="p">:</span>
<span class="ss">&quot;people_street_id_fkey&quot;</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">street_id</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="n">streets</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="transactions">
<h2><span class="section-number">15.1.14. </span>Transactions<a class="headerlink" href="#transactions" title="Permalink to this headline"></a></h2>
<p>When adding, changing, or deleting data in a database, it is always important
that the database is left in a good state if something goes wrong. Most
databases provide a feature called transaction support. Transactions allow you
to create a rollback position that you can return to if your modifications to
the database did not run as planned.</p>
<p>Take a scenario where you have an accounting system. You need to transfer funds
from one account and add them to another. The sequence of steps would go like
this:</p>
<ul class="simple">
<li><p>remove R20 from Joe</p></li>
<li><p>add R20 to Anne</p></li>
</ul>
<p>If something goes wrong during the process (e.g. power failure), the
transaction will be rolled back.</p>
</section>
<section id="ic">
<h2><span class="section-number">15.1.15. </span>In Conclusion<a class="headerlink" href="#ic" title="Permalink to this headline"></a></h2>
<p>Databases allow you to manage data in a structured way using simple code
structures.</p>
</section>
<section id="wn">
<h2><span class="section-number">15.1.16. </span>What’s Next?<a class="headerlink" href="#wn" title="Permalink to this headline"></a></h2>
<p>Now that we’ve looked at how databases work in theory, let’s create a new
database to implement the theory we’ve covered.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="15. Module: Database Concepts with PostgreSQL" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="data_model.html" class="btn btn-neutral float-right" title="15.2. Lesson: Implementing the Data Model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2002-now, QGIS project.
      <span class="lastupdated">Last updated on Oct 24, 2021 11:42.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <!-- Transifex follows a particular logic to build target pages
example of expected format: .../locale-en-lc-messages-docs-gentle-gis-introduction-data-capture-po--release-3-16 
for the page ...3.16/docs/gentle_gis_introduction/data_capture.html in release_3.16 branch-->
<!--Make sure that mismatching languages codes are converted-->


  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-info-circle"> QGIS Documentation </span>
      v: testing
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
      <dl>
        <dt>Languages</dt>
        
          <dd><a href="https://docs.qgis.org/testing/en/docs/training_manual/database_concepts/db_intro.html">en</a></dd>
        
      </dl>

      <dl>
        <dt>Versions</dt>
        
          <dd><a href="https://docs.qgis.org/testing/en/docs/training_manual/database_concepts/db_intro.html">testing</a></dd>
        
          <dd><a href="https://docs.qgis.org/latest/en/docs/training_manual/database_concepts/db_intro.html">latest</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.16/en/docs/training_manual/database_concepts/db_intro.html">3.16</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.10/en/docs/training_manual/database_concepts/db_intro.html">3.10</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.4/en/docs/training_manual/database_concepts/db_intro.html">3.4</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.18/en/docs/training_manual/database_concepts/db_intro.html">2.18</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.14/en/docs/training_manual/database_concepts/db_intro.html">2.14</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.8/en/docs/training_manual/database_concepts/db_intro.html">2.8</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.6/en/docs/training_manual/database_concepts/db_intro.html">2.6</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.2/en/docs/training_manual/database_concepts/db_intro.html">2.2</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.0/en/docs/training_manual/database_concepts/db_intro.html">2.0</a></dd>
        
          <dd><a href="https://docs.qgis.org/1.8/en/docs/training_manual/database_concepts/db_intro.html">1.8</a></dd>
        
      </dl>

       
       <dl>
        <dt>Downloads</dt>
        
          <dd><a href="https://docs.qgis.org/testing/pdf">PDF</a></dd>
        
          <dd><a href="https://docs.qgis.org/testing/zip">HTML</a></dd>
        
      </dl>
      

      
       
      <dl>
        <dt>Contribute to Docs</dt>
          <dd>
            <a href="https://github.com/qgis/QGIS-Documentation/edit/master/docs/training_manual/database_concepts/db_intro.rst" target="_blank" rel="noopener noreferrer">Edit on GitHub</a>
          </dd>
          
          
          <dd>
            <a href="https://github.com/qgis/QGIS-Documentation/issues" target="_blank" rel="noopener noreferrer">Report Issue</a>
          </dd>
      </dl>
      

      <dl>
        <dt>On QGIS Project</dt>
          <dd>
            <a href="https://qgis.org/en" target="_blank" rel="noopener noreferrer">Home</a>
          </dd>
          <dd>
            <a href="https://qgis.org/api/" target="_blank" rel="noopener noreferrer">C++ API</a>
          </dd>
          <dd>
            <a href="https://qgis.org/pyqgis/master" target="_blank" rel="noopener noreferrer">PyQGIS API</a>
          </dd>
          <dd>
            <a href="https://github.com/qgis/QGIS/tree/master" target="_blank" rel="noopener noreferrer">Source</a>
          </dd>
      </dl>

    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>