<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>21.2. User Authentication Workflows &mdash; QGIS Documentation  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/qgis_docs.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/qgis_topbar.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/qgis_logo.ico"/>
    <link rel="canonical" href="https://docs.qgis.org/latest/en/docs/user_manual/auth_system/auth_workflows.html"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="21.3. Security Considerations" href="auth_considerations.html" />
    <link rel="prev" title="21.1. Authentication System Overview" href="auth_overview.html" /> 
</head>

<body class="wy-body-for-nav">

  <nav class="release_status_topbar">
    <div class="row isTesting">
     This documentation is a work in progress. For the Long Term Release and translations, please visit the <a href="https://docs.qgis.org/latest/en/docs/user_manual/auth_system/auth_workflows.html">latest version</a>.
    </div>
  </nav>

   

 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
   
            <a href="../../index.html" class="icon icon-home"> QGIS Documentation
            <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                testing
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
   <a href= "../../../genindex.html">Index</a>
 
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">For Users</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">QGIS Desktop User Guide/Manual (QGIS Testing)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../preamble/preamble.html">1. Preamble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/foreword.html">2. Foreword</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/conventions.html">3. Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/features.html">4. Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/getting_started.html">5. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/project_files.html">6. Working with Project Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/qgis_gui.html">7. QGIS GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/browser.html">8. The Browser panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/qgis_configuration.html">9. QGIS Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_projections/working_with_projections.html">10. Working with Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/general_tools.html">11. General Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../style_library/index.html">12. The Style Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../managing_data_source/index.html">13. Managing Data Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_vector/index.html">14. Working with Vector Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_raster/index.html">15. Working with Raster Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_mesh/mesh_properties.html">16. Working with Mesh Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_vector_tiles/vector_tiles_properties.html">17. Working with Vector Tiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../print_composer/index.html">18. Laying out the maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_ogc/ogc_client_support.html">19. Working with OGC / ISO protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_gps/index.html">20. Working with GPS Data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">21. Authentication System</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="auth_overview.html">21.1. Authentication System Overview</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">21.2. User Authentication Workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#http-s-authentication">21.2.1. HTTP(S) authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="#database-authentication">21.2.2. Database authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pki-authentication">21.2.3. PKI authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="#handling-bad-layers">21.2.4. Handling bad layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#changing-authentication-config-id">21.2.5. Changing authentication config ID</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qgis-server-support">21.2.6. QGIS Server support</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssl-server-exceptions">21.2.7. SSL server exceptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="auth_considerations.html">21.3. Security Considerations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../grass_integration/grass_integration.html">22. GRASS GIS Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing/index.html">23. QGIS processing framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing_algs/index.html">24. Processing providers and algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins/index.html">25. Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/help_and_support.html">26. Help and Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/contributors.html">27. Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendices/index.html">28. Appendices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../literature_web/literature_and_web_references.html">29. Literature and Web References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../server_manual/index.html">QGIS Server Guide/Manual (QGIS Testing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training_manual/index.html">Training Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gentle_gis_introduction/index.html">A Gentle Introduction to GIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Writers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation_guidelines/index.html">Documentation Guidelines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../pyqgis_developer_cookbook/index.html">PyQGIS Cookbook (QGIS Testing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers_guide/index.html">Developers Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QGIS Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">QGIS User Guide</a> &raquo;</li>
          <li><a href="index.html"><span class="section-number">21. </span>Authentication System</a> &raquo;</li>
      <li><span class="section-number">21.2. </span>User Authentication Workflows</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/qgis/QGIS-Documentation/blob/master/docs/user_manual/auth_system/auth_workflows.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="auth_overview.html" class="btn btn-neutral float-left" title="21.1. Authentication System Overview" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="auth_considerations.html" class="btn btn-neutral float-right" title="21.3. Security Considerations" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="user-authentication-workflows">
<span id="authentication-workflow"></span><h1><span class="section-number">21.2. </span>User Authentication Workflows<a class="headerlink" href="#user-authentication-workflows" title="Permalink to this headline"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#http-s-authentication" id="id22">HTTP(S) authentication</a></p></li>
<li><p><a class="reference internal" href="#database-authentication" id="id23">Database authentication</a></p></li>
<li><p><a class="reference internal" href="#pki-authentication" id="id24">PKI authentication</a></p>
<ul>
<li><p><a class="reference internal" href="#authorities" id="id25">Authorities</a></p></li>
<li><p><a class="reference internal" href="#identities" id="id26">Identities</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#handling-bad-layers" id="id27">Handling bad layers</a></p></li>
<li><p><a class="reference internal" href="#changing-authentication-config-id" id="id28">Changing authentication config ID</a></p></li>
<li><p><a class="reference internal" href="#qgis-server-support" id="id29">QGIS Server support</a></p></li>
<li><p><a class="reference internal" href="#ssl-server-exceptions" id="id30">SSL server exceptions</a></p></li>
</ul>
</div>
<figure class="align-center" id="id1">
<span id="figure-authusage"></span><img alt="../../../_images/auth-user-usage.png" src="../../../_images/auth-user-usage.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.19 </span><span class="caption-text">Generic user workflow</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<section id="http-s-authentication">
<h2><a class="toc-backref" href="#id22"><span class="section-number">21.2.1. </span>HTTP(S) authentication</a><a class="headerlink" href="#http-s-authentication" title="Permalink to this headline"></a></h2>
<p>One of the most common resource connections is via HTTP(S), e.g. web mapping
servers, and authentication method plugins often work for these types of
connections. Method plugins have access to the HTTP request object and can
manipulate both the request as well as its headers. This allows for many forms
of internet-based authentication. When connecting via HTTP(S) using the standard
username/password authentication method will attempt HTTP BASIC authentication
upon connection.</p>
<figure class="align-center" id="id2">
<span id="figure-auth-https"></span><img alt="../../../_images/auth-http-basic-wms.png" src="../../../_images/auth-http-basic-wms.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.20 </span><span class="caption-text">Configuring a WMS connection for HTTP BASIC</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="database-authentication">
<h2><a class="toc-backref" href="#id23"><span class="section-number">21.2.2. </span>Database authentication</a><a class="headerlink" href="#database-authentication" title="Permalink to this headline"></a></h2>
<p>Connections to database resources are generally stored as <code class="docutils literal notranslate"><span class="pre">key=value</span></code> pairs,
which will expose usernames and (optionally) passwords, if <em>not</em> using an
authentication configuration. When configuring with the auth system, the
<code class="docutils literal notranslate"><span class="pre">key=value</span></code> will be an abstracted representation of the credentials, e.g.
<code class="docutils literal notranslate"><span class="pre">authfg=81t21b9</span></code>.</p>
<figure class="align-center" id="id3">
<span id="figure-auth-database"></span><img alt="../../../_images/auth-db-ssl-pki.png" src="../../../_images/auth-db-ssl-pki.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.21 </span><span class="caption-text">Configuring a Postgres SSL-with-PKI connection</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="pki-authentication">
<h2><a class="toc-backref" href="#id24"><span class="section-number">21.2.3. </span>PKI authentication</a><a class="headerlink" href="#pki-authentication" title="Permalink to this headline"></a></h2>
<p>When configuring PKI components within the authentication system, you have the
option of importing components into the database or referencing component files
stored on your filesystem. The latter may be useful if such components change
frequently, or where the components will be replaced by a system administrator.
In either instance you will need to store any passphrase needed to access
private keys within the database.</p>
<figure class="align-center" id="id4">
<span id="figure-auth-pki-config"></span><img alt="../../../_images/auth-pki-config.png" src="../../../_images/auth-pki-config.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.22 </span><span class="caption-text">PKI configuration workflow</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>All PKI components can be managed in separate editors within the <strong>Certificate
Manager</strong>, which can be accessed in the <span class="guilabel">Authentication</span> tab in QGIS
<cite>Options</cite> dialog (<span class="menuselection">Settings ► Options</span>) by clicking the
<span class="guilabel">Manage Certificates</span> button.</p>
<figure class="align-center" id="id5">
<span id="figure-auth-pki-certif"></span><img alt="../../../_images/auth-open-Certificate-manager.png" src="../../../_images/auth-open-Certificate-manager.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.23 </span><span class="caption-text">Opening the Certificate Manager</span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>In the <span class="guilabel">Certificate Manager</span>, there are editors for <strong>Identities</strong>,
<strong>Servers</strong> and <strong>Authorities</strong>. Each of these are contained in their own tabs,
and are described below in the order they are encountered in the workflow chart
above. The tab order is relative to frequently accessed editors once you are
accustomed to the workflow.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because all authentication system edits write immediately to the
authentication database, there is no need to click the <span class="guilabel">Options</span>
dialog <span class="guilabel">OK</span> button for any changes to be saved. This is unlike other
settings in the Options dialog.</p>
</div>
<section id="authorities">
<h3><a class="toc-backref" href="#id25"><span class="section-number">21.2.3.1. </span>Authorities</a><a class="headerlink" href="#authorities" title="Permalink to this headline"></a></h3>
<p>You can manage available Certificate Authorities (CAs) from the <strong>Authorities</strong>
tab in the <strong>Certificate manager</strong> from the <strong>Authentication</strong> tab of
the QGIS <strong>Options</strong> dialog.</p>
<p>As referenced in the workflow chart above, the first step is to import or
reference a file of CAs. This step is optional, and may be unnecessary if your
PKI trust chain originates from root CAs already installed in your operating
system (OS), such as a certificate from a commercial certificate vendor. If your
authenticating root CA is not in the OS’s trusted root CAs, it will need to be
imported or have its file system path referenced. (Contact your system
administrator if unsure.)</p>
<figure class="align-center" id="id6">
<span id="figure-auth-pki-editor"></span><img alt="../../../_images/auth-editor-authorities.png" src="../../../_images/auth-editor-authorities.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.24 </span><span class="caption-text">Authorities editor</span><a class="headerlink" href="#id6" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>By default, the root CAs from your OS are available; however, their trust
settings are not inherited. You should review the certificate trust policy
settings, especially if your OS root CAs have had their policies adjusted. Any
certificate that is expired will be set to untrusted and will not be used in
secure server connections, unless you specifically override its trust policy. To
see the QGIS-discoverable trust chain for any certificate, select it and click
the <a class="reference internal" href="../../../_images/metadata.png"><img alt="metadata" src="../../../_images/metadata.png" style="width: 1.5em;" /></a> <sup>Show information for certificate</sup>.</p>
<figure class="align-center" id="id7">
<span id="figure-auth-pki-info"></span><img alt="../../../_images/auth-authority-imported_cert-info-chain.png" src="../../../_images/auth-authority-imported_cert-info-chain.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.25 </span><span class="caption-text">Certificate info dialog</span><a class="headerlink" href="#id7" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>You can edit the <span class="guilabel">Trust policy</span> <a class="reference internal" href="../../../_images/selectstring.png"><img alt="selectString" src="../../../_images/selectstring.png" style="width: 2.5em;" /></a> for any selected
certificate within the chain. Any change in trust policy to a selected
certificate will not be saved to the database unless the <a class="reference internal" href="../../../_images/mActionFileSave.png"><img alt="fileSave" src="../../../_images/mActionFileSave.png" style="width: 1.5em;" /></a>
<sup>Save certificate trust policy change to database</sup> button is clicked
<em>per</em> selected certification. Closing the dialog will <strong>not</strong> apply the
policy changes.</p>
<figure class="align-center" id="id8">
<span id="figure-auth-pki-policy"></span><img alt="../../../_images/auth-authority-edit-trust_save-not-close.png" src="../../../_images/auth-authority-edit-trust_save-not-close.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.26 </span><span class="caption-text">Saving the trust policy changes</span><a class="headerlink" href="#id8" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>You can review the filtered CAs, both intermediate and root certificates, that
will be trusted for secure connections or change the default trust policy by
clicking the <a class="reference internal" href="../../../_images/mActionTransformSettings.png"><img alt="transformSettings" src="../../../_images/mActionTransformSettings.png" style="width: 1.5em;" /></a> <strong>Options</strong> button.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Changing the default trust policy may result in problems with secure
connections.</p>
</div>
<figure class="align-center" id="id9">
<span id="figure-auth-pki-options"></span><img alt="../../../_images/auth-editor-authorities_utilities-menu.png" src="../../../_images/auth-editor-authorities_utilities-menu.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.27 </span><span class="caption-text">Authorities options menu</span><a class="headerlink" href="#id9" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>You can import CAs or save a file system path from a file that contains multiple
CAs, or import individual CAs. The standard PEM format for files that contain
multiple CA chain certifications has the root cert at the bottom of the file and
all subsequently signed child certificates above, towards the beginning of the
file.</p>
<p>The CA certificate import dialog will find all CA certificates within the file,
regardless of order, and also offers the option to import certificates that are
considered invalid (in case you want to override their trust policy). You can
override the trust policy upon import, or do so later within the <strong>Authorities</strong>
editor.</p>
<figure class="align-center" id="id10">
<span id="figure-auth-pki-import"></span><img alt="../../../_images/auth-authority-import.png" src="../../../_images/auth-authority-import.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.28 </span><span class="caption-text">Import certificates dialog</span><a class="headerlink" href="#id10" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are pasting certificate information into the <span class="guilabel">PEM text</span>
field, note that encrypted certificates are not supported.</p>
</div>
</section>
<section id="identities">
<h3><a class="toc-backref" href="#id26"><span class="section-number">21.2.3.2. </span>Identities</a><a class="headerlink" href="#identities" title="Permalink to this headline"></a></h3>
<p>You can manage available client identity bundles from the <span class="guilabel">Identities</span>
tab in the <span class="guilabel">Certificate manager</span> from the <strong>Authentication</strong> tab of the
QGIS <strong>Options</strong> dialog. An identity is what authenticates you against a
PKI-enabled service and usually consists of a client certificate and
private key, either as separate files or combined into a single “bundled”
file. The bundle or private key is often passphrase-protected.</p>
<p>Once you have any Certificate Authorities (CAs) imported you can optionally
import any identity bundles into the authentication database. If you do not wish
to store the identities, you can reference their component file system paths
within an individual authentication configuration.</p>
<figure class="align-center" id="id11">
<span id="figure-auth-pki-identities"></span><img alt="../../../_images/auth-editor-identities.png" src="../../../_images/auth-editor-identities.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.29 </span><span class="caption-text">Identities editor</span><a class="headerlink" href="#id11" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>When importing an identity bundle, it can be passphrase-protected or
unprotected, and can contain CA certificates forming a trust chain. Trust chain
certifications will not be imported here; they can be added separately under the
<span class="guilabel">Authorities</span> tab.</p>
<p>Upon import the bundle’s certificate and private key will be stored in the
database, with the key’s storage encrypted using the QGIS master password.
Subsequent usage of the stored bundle from the database will only require input
of the master password.</p>
<p>Personal identity bundles consisting of PEM/DER (.pem/.der) and PKCS#12
(.p12/.pfx) components are supported. If a key or bundle is
passphrase-protected, the password will be required to validate the component
prior to import. Likewise, if the client certificate in the bundle is invalid
(for example, its effective date has not yet started or has elapsed) the bundle
can not be imported.</p>
<figure class="align-center" id="id12">
<span id="figure-auth-pki-identities-import"></span><img alt="../../../_images/auth-identity-import_paths.png" src="../../../_images/auth-identity-import_paths.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.30 </span><span class="caption-text">PEM/DER identity import</span><a class="headerlink" href="#id12" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id13">
<span id="figure-auth-pki-identities-import-2"></span><img alt="../../../_images/auth-identity-import_bundle-valid.png" src="../../../_images/auth-identity-import_bundle-valid.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.31 </span><span class="caption-text">PKCS#12 identity import</span><a class="headerlink" href="#id13" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="handling-bad-layers">
<h2><a class="toc-backref" href="#id27"><span class="section-number">21.2.4. </span>Handling bad layers</a><a class="headerlink" href="#handling-bad-layers" title="Permalink to this headline"></a></h2>
<p>Occasionally, the authentication configuration ID that is saved with a project
file is no longer valid, possibly because the current authentication database
is different than when the project was last saved, or due to a credentials
mismatch. In such cases the <span class="guilabel">Handle bad layers</span> dialog will be
presented upon QGIS launch.</p>
<figure class="align-center" id="id14">
<span id="figure-auth-pki-badlayers"></span><img alt="../../../_images/auth-handle-bad-layers.png" src="../../../_images/auth-handle-bad-layers.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.32 </span><span class="caption-text">Handle bad layers with authentication</span><a class="headerlink" href="#id14" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>If a data source is found to have an authentication configuration ID associated
with it, you will be able to edit it. Doing so will automatically edit the data
source string, much in the same way as opening the project file in a text editor
and editing the string.</p>
<figure class="align-center" id="id15">
<span id="figure-auth-pki-badlayers-edit"></span><img alt="../../../_images/auth-handle-bad-layers-edit.png" src="../../../_images/auth-handle-bad-layers-edit.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.33 </span><span class="caption-text">Edit bad layer’s authentication config ID</span><a class="headerlink" href="#id15" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="changing-authentication-config-id">
<h2><a class="toc-backref" href="#id28"><span class="section-number">21.2.5. </span>Changing authentication config ID</a><a class="headerlink" href="#changing-authentication-config-id" title="Permalink to this headline"></a></h2>
<p>Occasionally, you will need to change the authentication configuration ID that
is associated with accessing a resource. There are instances where this is
useful:</p>
<ul class="simple">
<li><p><strong>Resource auth config ID is no longer valid</strong>: This can occur when you have
switched auth databases add need to <em>align</em> a new configuration to the ID
already associated with a resource.</p></li>
<li><p><strong>Shared project files</strong>: If you intended to share projects between users, e.g.
via a shared file server, you can <em>predefine</em> a 7-character (containing
<strong>a-z</strong> and/or <strong>0-9</strong>) that is associated with the resource. Then, individual
users change the ID of an authentication configuration that is specific to
their credentials of the resource. When the project is opened, the ID is found
in the authentication database, but the credentials are different per user.</p></li>
</ul>
<figure class="align-center" id="id16">
<span id="figure-auth-id"></span><img alt="../../../_images/auth-change-config-id.png" src="../../../_images/auth-change-config-id.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.34 </span><span class="caption-text">Changing a layer’s authentication config ID (unlocked yellow text field)</span><a class="headerlink" href="#id16" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Changing the auth config ID is considered an advanced operation and should
only be done with full knowledge as to why it is necessary. This is why there
is a lock button that needs clicked, to unlock the ID’s text field prior to
editing the ID.</p>
</div>
</section>
<section id="qgis-server-support">
<h2><a class="toc-backref" href="#id29"><span class="section-number">21.2.6. </span>QGIS Server support</a><a class="headerlink" href="#qgis-server-support" title="Permalink to this headline"></a></h2>
<p>When using a project file, with layers that have authentication configurations,
as a basis for a map in QGIS Server, there are a couple of additional setup
steps necessary for QGIS to load the resources:</p>
<ul class="simple">
<li><p>Authentication database needs to be available</p></li>
<li><p>Authentication database’s master password needs to be available</p></li>
</ul>
<p>When instantiating the authentication system, Server will create or use
<code class="file docutils literal notranslate"><span class="pre">qgis-auth.db</span></code> file in the active <a class="reference internal" href="../introduction/qgis_configuration.html#user-profiles"><span class="std std-ref">user profile</span></a>,
or the  directory defined by the
<code class="docutils literal notranslate"><span class="pre">QGIS_AUTH_DB_DIR_PATH</span></code> environment variable. It may be that the Server’s user
has no HOME directory, in which case, use the environment variable to define a
directory that the Server’s user has read/write permissions and is not located
within the web-accessible directories.</p>
<p>To pass the master password to Server, write it to the first line of file at a
path on the file system readable by the Server processes user and defined using
the <code class="docutils literal notranslate"><span class="pre">QGIS_AUTH_PASSWORD_FILE</span></code> environment variable. Ensure to limit the file
as only readable by the Server’s process user and to not store the file within
web-accessible directories.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">QGIS_AUTH_PASSWORD_FILE</span></code> variable will be removed from the Server
environment immediately after accessing.</p>
</div>
</section>
<section id="ssl-server-exceptions">
<h2><a class="toc-backref" href="#id30"><span class="section-number">21.2.7. </span>SSL server exceptions</a><a class="headerlink" href="#ssl-server-exceptions" title="Permalink to this headline"></a></h2>
<figure class="align-center" id="id17">
<span id="figure-auth-server"></span><img alt="../../../_images/auth-ssl-config.png" src="../../../_images/auth-ssl-config.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.35 </span><span class="caption-text">SSL server exception</span><a class="headerlink" href="#id17" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>You can manage SSL server configurations and exceptions from the <strong>Servers</strong> tab
in the <strong>Authentication</strong> section of the QGIS <strong>Options</strong> dialog.</p>
<p>Sometimes, when connecting to an SSL server, there are errors with the SSL
“handshake” or the server’s certificate. You can ignore those errors or create
an SSL server configuration as an exception. This is similar to how web browsers
allow you to override SSL errors, but with more granular control.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You should not create an SSL server configuration unless you have complete
knowledge of the entire SSL setup between the server and client. Instead,
report the issue to the server administrator.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some PKI setups use a completely different CA trust chain to validate client
identities than the chain used to validate the SSL server certificate. In
such circumstances, any configuration created for the connecting server will
not necessarily fix an issue with the validation of your client identity, and
only your client identity’s issuer or server administrator can fix the issue.</p>
</div>
<p>You can pre-configure an SSL server configuration by clicking the <a class="reference internal" href="../../../_images/symbologyAdd.png"><img alt="signPlus" src="../../../_images/symbologyAdd.png" style="width: 1.5em;" /></a>
button. Alternatively, you can add a configuration when an SSL error occurs
during a connection and you are presented with an <strong>SSL Error</strong> dialog (where
the error can be ignored temporarily or saved to the database and ignored):</p>
<figure class="align-center" id="id18">
<span id="figure-auth-server-config"></span><img alt="../../../_images/auth-server-exception.png" src="../../../_images/auth-server-exception.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.36 </span><span class="caption-text">Manually adding configuration</span><a class="headerlink" href="#id18" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id19">
<span id="figure-auth-server-error"></span><img alt="../../../_images/auth-server-error-add-exception.png" src="../../../_images/auth-server-error-add-exception.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.37 </span><span class="caption-text">Adding configuration during SSL error</span><a class="headerlink" href="#id19" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Once an SSL configuration is saved to the database, it can be edited or deleted.</p>
<figure class="align-center" id="id20">
<span id="figure-auth-server-ssl"></span><img alt="../../../_images/auth-editor-servers.png" src="../../../_images/auth-editor-servers.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.38 </span><span class="caption-text">Existing SSL configuration</span><a class="headerlink" href="#id20" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id21">
<span id="figure-auth-server-ssledit"></span><img alt="../../../_images/auth-server-edit.png" src="../../../_images/auth-server-edit.png" />
<figcaption>
<p><span class="caption-number">Fig. 21.39 </span><span class="caption-text">Editing an existing SSL configuration</span><a class="headerlink" href="#id21" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>If you want to pre-configure an SSL configuration and the import dialog is not
working for your server’s connection, you can manually trigger a connection via
the <strong>Python Console</strong> by running the following code (replace
<code class="docutils literal notranslate"><span class="pre">https://bugreports.qt-project.org</span></code> with the URL of your server):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qgis.PyQt.QtNetwork</span> <span class="kn">import</span> <span class="n">QNetworkRequest</span>
<span class="kn">from</span> <span class="nn">qgis.PyQt.QtCore</span> <span class="kn">import</span> <span class="n">QUrl</span>
<span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="n">QgsNetworkAccessManager</span>

<span class="n">req</span> <span class="o">=</span> <span class="n">QNetworkRequest</span><span class="p">(</span><span class="n">QUrl</span><span class="p">(</span><span class="s1">&#39;https://bugreports.qt-project.org&#39;</span><span class="p">))</span>
<span class="n">reply</span> <span class="o">=</span> <span class="n">QgsNetworkAccessManager</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
</pre></div>
</div>
<p>This will open an SSL error dialog if any errors occur, where you can choose to
save the configuration to the database.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="auth_overview.html" class="btn btn-neutral float-left" title="21.1. Authentication System Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="auth_considerations.html" class="btn btn-neutral float-right" title="21.3. Security Considerations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2002-now, QGIS project.
      <span class="lastupdated">Last updated on Oct 19, 2021 22:25.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <!-- Transifex follows a particular logic to build target pages
example of expected format: .../locale-en-lc-messages-docs-gentle-gis-introduction-data-capture-po--release-3-16 
for the page ...3.16/docs/gentle_gis_introduction/data_capture.html in release_3.16 branch-->
<!--Make sure that mismatching languages codes are converted-->


  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-info-circle"> QGIS Documentation </span>
      v: testing
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
      <dl>
        <dt>Languages</dt>
        
          <dd><a href="https://docs.qgis.org/testing/en/docs/user_manual/auth_system/auth_workflows.html">en</a></dd>
        
      </dl>

      <dl>
        <dt>Versions</dt>
        
          <dd><a href="https://docs.qgis.org/testing/en/docs/user_manual/auth_system/auth_workflows.html">testing</a></dd>
        
          <dd><a href="https://docs.qgis.org/latest/en/docs/user_manual/auth_system/auth_workflows.html">latest</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.16/en/docs/user_manual/auth_system/auth_workflows.html">3.16</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.10/en/docs/user_manual/auth_system/auth_workflows.html">3.10</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.4/en/docs/user_manual/auth_system/auth_workflows.html">3.4</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.18/en/docs/user_manual/auth_system/auth_workflows.html">2.18</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.14/en/docs/user_manual/auth_system/auth_workflows.html">2.14</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.8/en/docs/user_manual/auth_system/auth_workflows.html">2.8</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.6/en/docs/user_manual/auth_system/auth_workflows.html">2.6</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.2/en/docs/user_manual/auth_system/auth_workflows.html">2.2</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.0/en/docs/user_manual/auth_system/auth_workflows.html">2.0</a></dd>
        
          <dd><a href="https://docs.qgis.org/1.8/en/docs/user_manual/auth_system/auth_workflows.html">1.8</a></dd>
        
      </dl>

       
       <dl>
        <dt>Downloads</dt>
        
          <dd><a href="https://docs.qgis.org/testing/pdf">PDF</a></dd>
        
          <dd><a href="https://docs.qgis.org/testing/zip">HTML</a></dd>
        
      </dl>
      

      
       
      <dl>
        <dt>Contribute to Docs</dt>
          <dd>
            <a href="https://github.com/qgis/QGIS-Documentation/edit/master/docs/user_manual/auth_system/auth_workflows.rst" target="_blank" rel="noopener noreferrer">Edit on GitHub</a>
          </dd>
          
          
          <dd>
            <a href="https://github.com/qgis/QGIS-Documentation/issues" target="_blank" rel="noopener noreferrer">Report Issue</a>
          </dd>
      </dl>
      

      <dl>
        <dt>On QGIS Project</dt>
          <dd>
            <a href="https://qgis.org/en" target="_blank" rel="noopener noreferrer">Home</a>
          </dd>
          <dd>
            <a href="https://qgis.org/api/" target="_blank" rel="noopener noreferrer">C++ API</a>
          </dd>
          <dd>
            <a href="https://qgis.org/pyqgis/master" target="_blank" rel="noopener noreferrer">PyQGIS API</a>
          </dd>
          <dd>
            <a href="https://github.com/qgis/QGIS/tree/master" target="_blank" rel="noopener noreferrer">Source</a>
          </dd>
      </dl>

    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>