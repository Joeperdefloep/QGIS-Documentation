<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>14.4. Working with the Attribute Table &mdash; QGIS Documentation  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/qgis_docs.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/qgis_topbar.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/qgis_logo.ico"/>
    <link rel="canonical" href="https://docs.qgis.org/latest/en/docs/user_manual/working_with_vector/attribute_table.html"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="14.5. Editing" href="editing_geometry_attributes.html" />
    <link rel="prev" title="14.3. List of functions" href="functions_list.html" /> 
</head>

<body class="wy-body-for-nav">

  <nav class="release_status_topbar">
    <div class="row isTesting">
     This documentation is a work in progress. For the Long Term Release and translations, please visit the <a href="https://docs.qgis.org/latest/en/docs/user_manual/working_with_vector/attribute_table.html">latest version</a>.
    </div>
  </nav>

   

 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
   
            <a href="../../index.html" class="icon icon-home"> QGIS Documentation
            <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                testing
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
   <a href= "../../../genindex.html">Index</a>
 
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">For Users</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">QGIS Desktop User Guide/Manual (QGIS Testing)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../preamble/preamble.html">1. Preamble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/foreword.html">2. Foreword</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/conventions.html">3. Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/features.html">4. Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/getting_started.html">5. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/project_files.html">6. Working with Project Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/qgis_gui.html">7. QGIS GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/browser.html">8. The Browser panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/qgis_configuration.html">9. QGIS Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_projections/working_with_projections.html">10. Working with Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/general_tools.html">11. General Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../style_library/index.html">12. The Style Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../managing_data_source/index.html">13. Managing Data Source</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">14. Working with Vector Data</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="vector_properties.html">14.1. The Vector Properties Dialog</a></li>
<li class="toctree-l3"><a class="reference internal" href="expression.html">14.2. Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="functions_list.html">14.3. List of functions</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">14.4. Working with the Attribute Table</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#foreword-spatial-and-non-spatial-tables">14.4.1. Foreword: Spatial and non-spatial tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#introducing-the-attribute-table-interface">14.4.2. Introducing the attribute table interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interacting-with-features-in-an-attribute-table">14.4.3. Interacting with features in an attribute table</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-action-on-features">14.4.4. Using action on features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#editing-attribute-values">14.4.5. Editing attribute values</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-one-or-many-to-many-relations">14.4.6. Creating one or many to many relations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#storing-and-fetching-an-external-resource">14.4.7. Storing and fetching an external resource</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="editing_geometry_attributes.html">14.5. Editing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_raster/index.html">15. Working with Raster Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_mesh/mesh_properties.html">16. Working with Mesh Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_vector_tiles/vector_tiles_properties.html">17. Working with Vector Tiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../print_composer/index.html">18. Laying out the maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_ogc/ogc_client_support.html">19. Working with OGC / ISO protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_gps/index.html">20. Working with GPS Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auth_system/index.html">21. Authentication System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../grass_integration/grass_integration.html">22. GRASS GIS Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing/index.html">23. QGIS processing framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing_algs/index.html">24. Processing providers and algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins/index.html">25. Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/help_and_support.html">26. Help and Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/contributors.html">27. Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendices/index.html">28. Appendices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../literature_web/literature_and_web_references.html">29. Literature and Web References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../server_manual/index.html">QGIS Server Guide/Manual (QGIS Testing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training_manual/index.html">Training Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gentle_gis_introduction/index.html">A Gentle Introduction to GIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Writers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation_guidelines/index.html">Documentation Guidelines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../pyqgis_developer_cookbook/index.html">PyQGIS Cookbook (QGIS Testing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers_guide/index.html">Developers Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QGIS Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">QGIS User Guide</a> &raquo;</li>
          <li><a href="index.html"><span class="section-number">14. </span>Working with Vector Data</a> &raquo;</li>
      <li><span class="section-number">14.4. </span>Working with the Attribute Table</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/qgis/QGIS-Documentation/blob/master/docs/user_manual/working_with_vector/attribute_table.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="functions_list.html" class="btn btn-neutral float-left" title="14.3. List of functions" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="editing_geometry_attributes.html" class="btn btn-neutral float-right" title="14.5. Editing" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="working-with-the-attribute-table">
<span id="sec-attribute-table"></span><span id="index-0"></span><h1><span class="section-number">14.4. </span>Working with the Attribute Table<a class="headerlink" href="#working-with-the-attribute-table" title="Permalink to this headline"></a></h1>
<p>The attribute table displays information on features of a selected layer. Each
row in the table represents a feature (with or without geometry), and each column
contains a particular piece of information about the feature.
Features in the table can be searched, selected, moved or even edited.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#foreword-spatial-and-non-spatial-tables" id="id22">Foreword: Spatial and non-spatial tables</a></p></li>
<li><p><a class="reference internal" href="#introducing-the-attribute-table-interface" id="id23">Introducing the attribute table interface</a></p>
<ul>
<li><p><a class="reference internal" href="#table-view-vs-form-view" id="id24">Table view vs Form view</a></p></li>
<li><p><a class="reference internal" href="#configuring-the-columns" id="id25">Configuring the columns</a></p>
<ul>
<li><p><a class="reference internal" href="#hiding-and-organizing-columns-and-enabling-actions" id="id26">Hiding and organizing columns and enabling actions</a></p></li>
<li><p><a class="reference internal" href="#resizing-columns-widths" id="id27">Resizing columns widths</a></p></li>
<li><p><a class="reference internal" href="#sorting-columns" id="id28">Sorting columns</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#formatting-of-table-cells-using-conditions" id="id29">Formatting of table cells using conditions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#interacting-with-features-in-an-attribute-table" id="id30">Interacting with features in an attribute table</a></p>
<ul>
<li><p><a class="reference internal" href="#selecting-features" id="id31">Selecting features</a></p></li>
<li><p><a class="reference internal" href="#filtering-features" id="id32">Filtering features</a></p></li>
<li><p><a class="reference internal" href="#storing-filter-expressions" id="id33">Storing filter expressions</a></p></li>
<li><p><a class="reference internal" href="#filtering-and-selecting-features-using-forms" id="id34">Filtering and selecting features using forms</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-action-on-features" id="id35">Using action on features</a></p>
<ul>
<li><p><a class="reference internal" href="#saving-selected-features-as-new-layer" id="id36">Saving selected features as new layer</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#editing-attribute-values" id="id37">Editing attribute values</a></p>
<ul>
<li><p><a class="reference internal" href="#using-the-field-calculator" id="id38">Using the Field Calculator</a></p></li>
<li><p><a class="reference internal" href="#creating-a-virtual-field" id="id39">Creating a Virtual Field</a></p></li>
<li><p><a class="reference internal" href="#using-the-quick-field-calculation-bar" id="id40">Using the Quick Field Calculation Bar</a></p></li>
<li><p><a class="reference internal" href="#editing-multiple-fields" id="id41">Editing multiple fields</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#creating-one-or-many-to-many-relations" id="id42">Creating one or many to many relations</a></p>
<ul>
<li><p><a class="reference internal" href="#introducing-1-n-relations" id="id43">Introducing 1-N relations</a></p>
<ul>
<li><p><a class="reference internal" href="#layers-in-1-n-relations" id="id44">Layers in 1-N relations</a></p></li>
<li><p><a class="reference internal" href="#foreign-keys-in-1-n-relations" id="id45">Foreign keys in 1-N relations</a></p></li>
<li><p><a class="reference internal" href="#defining-1-n-relations" id="id46">Defining 1-N relations</a></p></li>
<li><p><a class="reference internal" href="#forms-for-1-n-relations" id="id47">Forms for 1-N relations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#introducing-many-to-many-n-m-relations" id="id48">Introducing many-to-many (N-M) relations</a></p></li>
<li><p><a class="reference internal" href="#introducing-polymorphic-relations" id="id49">Introducing polymorphic relations</a></p>
<ul>
<li><p><a class="reference internal" href="#defining-polymorphic-relations" id="id50">Defining polymorphic relations</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#storing-and-fetching-an-external-resource" id="id51">Storing and fetching an external resource</a></p>
<ul>
<li><p><a class="reference internal" href="#configuring-an-external-storage" id="id52">Configuring an external storage</a></p></li>
<li><p><a class="reference internal" href="#using-an-external-storage" id="id53">Using an external storage</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="foreword-spatial-and-non-spatial-tables">
<span id="non-spatial-attribute-tables"></span><span id="index-1"></span><h2><a class="toc-backref" href="#id22"><span class="section-number">14.4.1. </span>Foreword: Spatial and non-spatial tables</a><a class="headerlink" href="#foreword-spatial-and-non-spatial-tables" title="Permalink to this headline"></a></h2>
<p>QGIS allows you to load spatial and non-spatial layers. This currently includes
tables supported by OGR and delimited text, as well as the PostgreSQL, MSSQL,
SpatiaLite and Oracle provider. All loaded layers are listed in
the <span class="guilabel">Layers</span> panel. Whether a layer is spatially enabled or not
determines whether you can interact with it on the map.</p>
<p>Non-spatial tables can be browsed and edited using the attribute table view.
Furthermore, they can be used for field lookups.
For example, you can use columns of a non-spatial table to define attribute
values, or a range of values that are allowed, to be added to a specific vector
layer during digitizing. Have a closer look at the edit widget in section
<a class="reference internal" href="vector_properties.html#vector-attributes-menu"><span class="std std-ref">Attributes Form Properties</span></a> to find out more.</p>
</section>
<section id="introducing-the-attribute-table-interface">
<span id="attribute-table-overview"></span><h2><a class="toc-backref" href="#id23"><span class="section-number">14.4.2. </span>Introducing the attribute table interface</a><a class="headerlink" href="#introducing-the-attribute-table-interface" title="Permalink to this headline"></a></h2>
<p>To open the attribute table for a vector layer, activate the layer by
clicking on it in the <a class="reference internal" href="../introduction/general_tools.html#label-legend"><span class="std std-ref">Layers Panel</span></a>. Then, from the main
<span class="menuselection">Layer</span> menu, choose <a class="reference internal" href="../../../_images/mActionOpenTable.png"><img alt="openTable" src="../../../_images/mActionOpenTable.png" style="width: 1.5em;" /></a> <span class="menuselection">Open Attribute
Table</span>. It is also possible to right-click on the layer and choose
<a class="reference internal" href="../../../_images/mActionOpenTable.png"><img alt="openTable" src="../../../_images/mActionOpenTable.png" style="width: 1.5em;" /></a> <span class="menuselection">Open Attribute Table</span> from the drop-down menu,
or to click on the <a class="reference internal" href="../../../_images/mActionOpenTable.png"><img alt="openTable" src="../../../_images/mActionOpenTable.png" style="width: 1.5em;" /></a> <span class="guilabel">Open Attribute Table</span> button
in the Attributes toolbar.
If you prefer shortcuts, <kbd class="kbd docutils literal notranslate">F6</kbd> will open the attribute table.
<kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Shift</kbd>+<kbd class="kbd docutils literal notranslate">F6</kbd></kbd> will open the attribute table filtered to selected features and
<kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">F6</kbd></kbd> will open the attribute table filtered to visible features.</p>
<p>This will open a new window that displays the feature attributes for the
layer (<a class="reference internal" href="#figure-attributes-table">figure_attributes_table</a>). According to the setting in
<span class="menuselection">Settings ► Options ► Data sources</span> menu, the attribute table
will open in a docked window or a regular window. The total number of features
in the layer and the number of currently selected/filtered features are shown
in the attribute table title, as well as if the layer is spatially limited.</p>
<figure class="align-center" id="id1">
<span id="figure-attributes-table"></span><img alt="../../../_images/vectorAttributeTable.png" src="../../../_images/vectorAttributeTable.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.69 </span><span class="caption-text">Attribute Table for regions layer</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The buttons at the top of the attribute table window provide the
following functionality:</p>
<span id="table-attribute-1"></span><table class="colwidths-auto longtable docutils align-default" id="id2">
<caption><span class="caption-number">Table 14.1 </span><span class="caption-text">Available Tools</span><a class="headerlink" href="#id2" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Icon</p></th>
<th class="head"><p>Label</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Default Shortcut</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../../../_images/mActionToggleEditing.png"><img alt="toggleEditing" src="../../../_images/mActionToggleEditing.png" style="width: 1.5em;" /></a></p></td>
<td><p>Toggle editing mode</p></td>
<td><p>Enable editing functionalities</p></td>
<td><p><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">E</kbd></kbd></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../_images/mActionMultiEdit.png"><img alt="multiEdit" src="../../../_images/mActionMultiEdit.png" style="width: 1.5em;" /></a></p></td>
<td><p>Toggle multi edit mode</p></td>
<td><p>Update multiple fields of many features</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../_images/mActionSaveEdits.png"><img alt="saveEdits" src="../../../_images/mActionSaveEdits.png" style="width: 1.5em;" /></a></p></td>
<td><p>Save Edits</p></td>
<td><p>Save current modifications</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../_images/mActionRefresh.png"><img alt="refresh" src="../../../_images/mActionRefresh.png" style="width: 1.5em;" /></a></p></td>
<td><p>Reload the table</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../_images/mActionNewTableRow.png"><img alt="newTableRow" src="../../../_images/mActionNewTableRow.png" style="width: 1.5em;" /></a></p></td>
<td><p>Add feature</p></td>
<td><p>Add new geometryless feature</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../_images/mActionDeleteSelectedFeatures.png"><img alt="deleteSelectedFeatures" src="../../../_images/mActionDeleteSelectedFeatures.png" style="width: 1.5em;" /></a></p></td>
<td><p>Delete selected features</p></td>
<td><p>Remove selected features from the layer</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../_images/mActionEditCut.png"><img alt="editCut" src="../../../_images/mActionEditCut.png" style="width: 1.5em;" /></a></p></td>
<td><p>Cut selected features to clipboard</p></td>
<td></td>
<td><p><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">X</kbd></kbd></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../_images/mActionCopySelected.png"><img alt="copySelected" src="../../../_images/mActionCopySelected.png" style="width: 1.5em;" /></a></p></td>
<td><p>Copy selected features to clipboard</p></td>
<td></td>
<td><p><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">C</kbd></kbd></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../_images/mActionEditPaste.png"><img alt="editPaste" src="../../../_images/mActionEditPaste.png" style="width: 1.5em;" /></a></p></td>
<td><p>Paste features from clipboard</p></td>
<td><p>Insert new features from copied ones</p></td>
<td><p><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">V</kbd></kbd></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../_images/mIconExpressionSelect.png"><img alt="expressionSelect" src="../../../_images/mIconExpressionSelect.png" style="width: 1.5em;" /></a></p></td>
<td><p>Select features using an Expression</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../_images/mActionSelectAll.png"><img alt="selectAll" src="../../../_images/mActionSelectAll.png" style="width: 1.5em;" /></a></p></td>
<td><p>Select All</p></td>
<td><p>Select all features in the layer</p></td>
<td><p><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">A</kbd></kbd></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../_images/mActionInvertSelection.png"><img alt="invertSelection" src="../../../_images/mActionInvertSelection.png" style="width: 1.5em;" /></a></p></td>
<td><p>Invert selection</p></td>
<td><p>Invert the current selection in the layer</p></td>
<td><p><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">R</kbd></kbd></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../_images/mActionDeselectActiveLayer.png"><img alt="deselectActiveLayer" src="../../../_images/mActionDeselectActiveLayer.png" style="width: 1.5em;" /></a></p></td>
<td><p>Deselect all</p></td>
<td><p>Deselect all features in the current layer</p></td>
<td><p><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">Shift</kbd>+<kbd class="kbd docutils literal notranslate">A</kbd></kbd></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../_images/mActionFilterMap.png"><img alt="filterMap" src="../../../_images/mActionFilterMap.png" style="width: 1.5em;" /></a></p></td>
<td><p>Filter/Select features using form</p></td>
<td></td>
<td><p><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">F</kbd></kbd></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../_images/mActionSelectedToTop.png"><img alt="selectedToTop" src="../../../_images/mActionSelectedToTop.png" style="width: 1.5em;" /></a></p></td>
<td><p>Move selected to top</p></td>
<td><p>Move selected rows to the top of the table</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../_images/mActionPanToSelected.png"><img alt="panToSelected" src="../../../_images/mActionPanToSelected.png" style="width: 1.5em;" /></a></p></td>
<td><p>Pan map to the selected rows</p></td>
<td></td>
<td><p><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">P</kbd></kbd></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../_images/mActionZoomToSelected.png"><img alt="zoomToSelected" src="../../../_images/mActionZoomToSelected.png" style="width: 1.5em;" /></a></p></td>
<td><p>Zoom map to the selected rows</p></td>
<td></td>
<td><p><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">J</kbd></kbd></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../_images/mActionNewAttribute.png"><img alt="newAttribute" src="../../../_images/mActionNewAttribute.png" style="width: 1.5em;" /></a></p></td>
<td><p>New field</p></td>
<td><p>Add a new field to the data source</p></td>
<td><p><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">W</kbd></kbd></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../_images/mActionDeleteAttribute.png"><img alt="deleteAttribute" src="../../../_images/mActionDeleteAttribute.png" style="width: 1.5em;" /></a></p></td>
<td><p>Delete field</p></td>
<td><p>Remove a field from the data source</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../_images/mActionCalculateField.png"><img alt="calculateField" src="../../../_images/mActionCalculateField.png" style="width: 1.5em;" /></a></p></td>
<td><p>Open field calculator</p></td>
<td><p>Update field for many features in a row</p></td>
<td><p><kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">I</kbd></kbd></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../_images/mActionConditionalFormatting.png"><img alt="conditionalFormatting" src="../../../_images/mActionConditionalFormatting.png" style="width: 1.5em;" /></a></p></td>
<td><p>Conditional formatting</p></td>
<td><p>Enable table formatting</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../_images/dock.png"><img alt="dock" src="../../../_images/dock.png" style="width: 1.5em;" /></a></p></td>
<td><p>Dock attribute table</p></td>
<td><p>Allows to dock/undock the attribute table</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../_images/mAction.png"><img alt="actionRun" src="../../../_images/mAction.png" style="width: 1.5em;" /></a></p></td>
<td><p>Actions</p></td>
<td><p>Lists the actions related to the layer</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Depending on the format of the data and the OGR library built with
your QGIS version, some tools may not be available.</p>
</div>
<p>Below these buttons is the Quick Field Calculation bar (enabled only in
<a class="reference internal" href="editing_geometry_attributes.html#sec-edit-existing-layer"><span class="std std-ref">edit mode</span></a>), which allows to quickly apply
calculations to all or part of the features in the layer. This bar uses the same
<a class="reference internal" href="expression.html#vector-expressions"><span class="std std-ref">expressions</span></a> as the <a class="reference internal" href="../../../_images/mActionCalculateField.png"><img alt="calculateField" src="../../../_images/mActionCalculateField.png" style="width: 1.5em;" /></a> <sup>Field
Calculator</sup> (see <a class="reference internal" href="#calculate-fields-values"><span class="std std-ref">Editing attribute values</span></a>).</p>
<section id="table-view-vs-form-view">
<span id="attribute-table-view"></span><h3><a class="toc-backref" href="#id24"><span class="section-number">14.4.2.1. </span>Table view vs Form view</a><a class="headerlink" href="#table-view-vs-form-view" title="Permalink to this headline"></a></h3>
<p>QGIS provides two view modes to easily manipulate data in the attribute table:</p>
<ul class="simple">
<li><p>The <a class="reference internal" href="../../../_images/mActionOpenTable.png"><img alt="openTable" src="../../../_images/mActionOpenTable.png" style="width: 1.5em;" /></a> <sup>Table view</sup>, displays values of multiple features in a
tabular mode, each row representing a feature and each column a field.</p></li>
<li><p>The <a class="reference internal" href="../../../_images/mActionFormView.png"><img alt="formView" src="../../../_images/mActionFormView.png" style="width: 1.2em;" /></a> <sup>Form view</sup> shows <a class="reference internal" href="vector_properties.html#maptips"><span class="std std-ref">feature identifiers</span></a> in a first panel and displays only the attributes of the clicked
identifier in the second one.
There is a pull-down menu at the top of the first panel where the “identifier”
can be specified using an attribute (<span class="guilabel">Column preview</span>) or an
<span class="guilabel">Expression</span>.
The pull-down also includes the last 10 expressions for re-use.
Form view uses the layer fields configuration
(see <a class="reference internal" href="vector_properties.html#vector-attributes-menu"><span class="std std-ref">Attributes Form Properties</span></a>).
You can browse through the feature identifiers with the arrows on the bottom
of the first panel. Once you markered the feature in yellow in the list it
is selected in yellow on the canvas. Use the <a class="reference internal" href="../../../_images/mActionZoomToSelected.png"><img alt="zoomToSelected" src="../../../_images/mActionZoomToSelected.png" style="width: 1.5em;" /></a> on top of the
attribute table to zoom to the feature. Clicking on an entry in the list
(without using the rectangles) makes a feature flash in red color once so you
can see where it is situated.</p></li>
</ul>
<p>You can switch from one mode to the other by clicking the corresponding icon at
the bottom right of the dialog.</p>
<p>You can also specify the <span class="guilabel">Default view</span> mode at the opening of the
attribute table in <span class="menuselection">Settings ► Options ► Data Sources</span> menu.
It can be ‘Remember last view’, ‘Table view’ or ‘Form view’.</p>
<figure class="align-center" id="id3">
<span id="figure-attribute-table-views"></span><img alt="../../../_images/attribute_table_views.png" src="../../../_images/attribute_table_views.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.70 </span><span class="caption-text">Attribute table in table view (top) vs form view (bottom)</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="configuring-the-columns">
<span id="configure-table-columns"></span><span id="index-2"></span><h3><a class="toc-backref" href="#id25"><span class="section-number">14.4.2.2. </span>Configuring the columns</a><a class="headerlink" href="#configuring-the-columns" title="Permalink to this headline"></a></h3>
<p>Right-click in a column header when in table view to have access to tools that
help you configure what can be displayed in the attribute table and how.</p>
<section id="hiding-and-organizing-columns-and-enabling-actions">
<h4><a class="toc-backref" href="#id26"><span class="section-number">14.4.2.2.1. </span>Hiding and organizing columns and enabling actions</a><a class="headerlink" href="#hiding-and-organizing-columns-and-enabling-actions" title="Permalink to this headline"></a></h4>
<p>By right-clicking in a column header, you can choose to hide it from the
attribute table. To change several columns behavior at once, unhide a column or
change the order of the columns, choose <span class="guilabel">Organize columns …</span>.
In the new dialog, you can:</p>
<ul class="simple">
<li><p>check/uncheck columns you want to show or hide</p></li>
<li><p>drag-and-drop items to reorder the columns in the attribute table. Note that
this change is for the table rendering and does not alter the fields order in
the layer datasource</p></li>
<li><p>enable a new virtual <span class="guilabel">Actions</span> column that displays in each row a
drop-down box or button list of actions for each row, see <a class="reference internal" href="vector_properties.html#actions-menu"><span class="std std-ref">Actions Properties</span></a>
for more information about actions.</p></li>
</ul>
</section>
<section id="resizing-columns-widths">
<h4><a class="toc-backref" href="#id27"><span class="section-number">14.4.2.2.2. </span>Resizing columns widths</a><a class="headerlink" href="#resizing-columns-widths" title="Permalink to this headline"></a></h4>
<p>Columns width can be set through a right-click on the column header and
select either:</p>
<ul class="simple">
<li><p><span class="guilabel">Set width…</span> to enter the desired value. By default, the current
value is displayed in the widget</p></li>
<li><p><span class="guilabel">Autosize</span> to resize at the best fit the column.</p></li>
</ul>
<p>It can also be changed by dragging the boundary on the right of the column
heading. The new size of the column is maintained for the layer, and restored at
the next opening of the attribute table.</p>
</section>
<section id="sorting-columns">
<h4><a class="toc-backref" href="#id28"><span class="section-number">14.4.2.2.3. </span>Sorting columns</a><a class="headerlink" href="#sorting-columns" title="Permalink to this headline"></a></h4>
<p>The table can be sorted by any column, by clicking on the column header. A
small arrow indicates the sort order (downward pointing means descending
values from the top row down, upward pointing means ascending values from
the top row down).
You can also choose to sort the rows with the <span class="guilabel">sort</span> option of the
column header context menu and write an expression, e.g. to sort the row
using multiple columns you can write <code class="docutils literal notranslate"><span class="pre">concat(col0,</span> <span class="pre">col1)</span></code>.</p>
<p>In form view, features identifier can be sorted using the <a class="reference internal" href="../../../_images/sort.png"><img alt="sort" src="../../../_images/sort.png" style="width: 1.5em;" /></a> <span class="guilabel">Sort
by preview expression</span> option.</p>
<div class="admonition tip" id="tip-sortcolumns">
<p class="admonition-title">Tip</p>
<p><strong>Sorting based on columns of different types</strong></p>
<p>Trying to sort an attribute table based on columns of string and numeric types
may lead to unexpected result because of the <code class="docutils literal notranslate"><span class="pre">concat(&quot;USE&quot;,</span> <span class="pre">&quot;ID&quot;)</span></code> expression
returning string values (ie, <code class="docutils literal notranslate"><span class="pre">'Borough105'</span> <span class="pre">&lt;</span> <span class="pre">'Borough6'</span></code>).
You can workaround this by using eg <code class="docutils literal notranslate"><span class="pre">concat(&quot;USE&quot;,</span> <span class="pre">lpad(&quot;ID&quot;,</span> <span class="pre">3,</span> <span class="pre">0))</span></code> which
returns <code class="docutils literal notranslate"><span class="pre">'Borough105'</span> <span class="pre">&gt;</span> <span class="pre">'Borough006'</span></code>.</p>
</div>
</section>
</section>
<section id="formatting-of-table-cells-using-conditions">
<span id="conditional-formatting"></span><span id="index-3"></span><h3><a class="toc-backref" href="#id29"><span class="section-number">14.4.2.3. </span>Formatting of table cells using conditions</a><a class="headerlink" href="#formatting-of-table-cells-using-conditions" title="Permalink to this headline"></a></h3>
<p>Conditional formatting settings can be used to highlight in the attribute
table features you may want to put a particular focus on, using custom
conditions on feature’s:</p>
<ul class="simple">
<li><p>geometry (e.g., identifying multi-parts features, small area ones or in a
defined map extent…);</p></li>
<li><p>or field value (e.g., comparing values to a threshold, identifying empty
cells…).</p></li>
</ul>
<p>You can enable the conditional formatting panel clicking on
<a class="reference internal" href="../../../_images/mActionConditionalFormatting.png"><img alt="conditionalFormatting" src="../../../_images/mActionConditionalFormatting.png" style="width: 1.5em;" /></a> at the top right of the attributes window in table
view (not available in form view).</p>
<p>The new panel allows user to add new rules to format rendering of
<a class="reference internal" href="../../../_images/radiobuttonon.png"><img alt="radioButtonOn" src="../../../_images/radiobuttonon.png" style="width: 1.5em;" /></a><span class="guilabel">Field</span> or <a class="reference internal" href="../../../_images/radiobuttonoff.png"><img alt="radioButtonOff" src="../../../_images/radiobuttonoff.png" style="width: 1.5em;" /></a><span class="guilabel">Full row</span>.
Adding new rule opens a form to define:</p>
<ul class="simple">
<li><p>the name of the rule;</p></li>
<li><p>a condition using any of the <a class="reference internal" href="expression.html#vector-expressions"><span class="std std-ref">expression builder</span></a>
functions;</p></li>
<li><p>the formatting: it can be choosen from a list of predefined formats or created
based on properties like:</p>
<ul>
<li><p>background and text colors;</p></li>
<li><p>use of icon;</p></li>
<li><p>bold, italic, underline, or strikeout;</p></li>
<li><p>font.</p></li>
</ul>
</li>
</ul>
<figure class="align-center" id="id4">
<span id="figure-conditional-format"></span><img alt="../../../_images/attribute_table_conditional_formating.png" src="../../../_images/attribute_table_conditional_formating.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.71 </span><span class="caption-text">Conditional Formatting of an attribute table</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="interacting-with-features-in-an-attribute-table">
<span id="index-4"></span><h2><a class="toc-backref" href="#id30"><span class="section-number">14.4.3. </span>Interacting with features in an attribute table</a><a class="headerlink" href="#interacting-with-features-in-an-attribute-table" title="Permalink to this headline"></a></h2>
<section id="selecting-features">
<h3><a class="toc-backref" href="#id31"><span class="section-number">14.4.3.1. </span>Selecting features</a><a class="headerlink" href="#selecting-features" title="Permalink to this headline"></a></h3>
<p>In table view, each row in the attribute table displays the attributes of a
unique feature in the layer. Selecting a row selects the feature and likewise,
selecting a feature in the map canvas (in case of geometry enabled layer)
selects the row in the attribute table. If the set of features selected in the
map canvas (or attribute table) is changed, then the selection is also updated
in the attribute table (or map canvas) accordingly.</p>
<p>Rows can be selected by clicking on the row number on the left side of the
row. <strong>Multiple rows</strong> can be marked by holding the <kbd class="kbd docutils literal notranslate">Ctrl</kbd> key.
A <strong>continuous selection</strong> can be made by holding the <kbd class="kbd docutils literal notranslate">Shift</kbd> key and
clicking on several row headers on the left side of the rows. All rows
between the current cursor position and the clicked row are selected.
Moving the cursor position in the attribute table, by clicking a cell in the
table, does not change the row selection. Changing the selection in the main
canvas does not move the cursor position in the attribute table.</p>
<p>In form view of the attribute table, features are by default identified in the
left panel by the value of their displayed field (see <a class="reference internal" href="vector_properties.html#maptips"><span class="std std-ref">Display Properties</span></a>). This
identifier can be replaced using the drop-down list at the top of the panel,
either by selecting an existing field or using a custom expression. You can
also choose to sort the list of features from the drop-down menu.</p>
<p>Click a value in the left panel to display the feature’s attributes in the
right one. To select a feature, you need to click inside the square symbol at
the left of the identifier. By default, the symbol turns into yellow. Like in
the table view, you can perform multiple feature selection using the keyboard
combinations previously exposed.</p>
<p>Beyond selecting features with the mouse, you can perform automatic selection
based on feature’s attribute using tools available in the attribute table
toolbar, such as (see section <a class="reference internal" href="../introduction/general_tools.html#automatic-selection"><span class="std std-ref">Automatic selection</span></a> and following one for
more information and use case):</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../_images/mIconExpressionSelect.png"><img alt="expressionSelect" src="../../../_images/mIconExpressionSelect.png" style="width: 1.5em;" /></a> <span class="guilabel">Select By Expression…</span></p></li>
<li><p><a class="reference internal" href="../../../_images/mIconFormSelect.png"><img alt="formSelect" src="../../../_images/mIconFormSelect.png" style="width: 1.5em;" /></a> <span class="guilabel">Select Features By Value…</span></p></li>
<li><p><a class="reference internal" href="../../../_images/mActionDeselectActiveLayer.png"><img alt="deselectActiveLayer" src="../../../_images/mActionDeselectActiveLayer.png" style="width: 1.5em;" /></a> <span class="guilabel">Deselect All Features from the Layer</span></p></li>
<li><p><a class="reference internal" href="../../../_images/mActionSelectAll.png"><img alt="selectAll" src="../../../_images/mActionSelectAll.png" style="width: 1.5em;" /></a> <span class="guilabel">Select All Features</span></p></li>
<li><p><a class="reference internal" href="../../../_images/mActionInvertSelection.png"><img alt="invertSelection" src="../../../_images/mActionInvertSelection.png" style="width: 1.5em;" /></a> <span class="guilabel">Invert Feature Selection</span>.</p></li>
</ul>
<p>It is also possible to select features using the <a class="reference internal" href="#filter-select-form"><span class="std std-ref">Filtering and selecting features using forms</span></a>.</p>
</section>
<section id="filtering-features">
<span id="filter-features"></span><h3><a class="toc-backref" href="#id32"><span class="section-number">14.4.3.2. </span>Filtering features</a><a class="headerlink" href="#filtering-features" title="Permalink to this headline"></a></h3>
<p>Once you have selected features in the attribute table, you may want to display
only these records in the table. This can be easily done using the
<span class="guilabel">Show Selected Features</span> item from the drop-down list at the bottom
left of the attribute table dialog. This list offers the following filters:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../_images/mActionOpenTable.png"><img alt="openTable" src="../../../_images/mActionOpenTable.png" style="width: 1.5em;" /></a> <span class="guilabel">Show All Features</span></p></li>
<li><p><a class="reference internal" href="../../../_images/mActionOpenTableSelected.png"><img alt="openTableSelected" src="../../../_images/mActionOpenTableSelected.png" style="width: 1.5em;" /></a> <span class="guilabel">Show Selected Features</span> - same as using
<span class="guilabel">Open Attribute Table (Selected Features)</span> from the <span class="guilabel">Layer</span>
menu or the <span class="guilabel">Attributes Toolbar</span> or pressing <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Shift</kbd>+<kbd class="kbd docutils literal notranslate">F6</kbd></kbd></p></li>
<li><p><a class="reference internal" href="../../../_images/mActionOpenTableVisible.png"><img alt="openTableVisible" src="../../../_images/mActionOpenTableVisible.png" style="width: 1.5em;" /></a> <span class="guilabel">Show Features visible on map</span> - same as using
<span class="guilabel">Open Attribute Table (Visible Features)</span> from the <span class="guilabel">Layer</span>
menu or the <span class="guilabel">Attributes Toolbar</span> or pressing <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">F6</kbd></kbd></p></li>
<li><p><a class="reference internal" href="../../../_images/mActionOpenTableEdited.png"><img alt="openTableEdited" src="../../../_images/mActionOpenTableEdited.png" style="width: 1.5em;" /></a> <span class="guilabel">Show Edited and New Features</span> - same as using
<span class="guilabel">Open Attribute Table (Edited and New Features)</span> from the <span class="guilabel">Layer</span>
menu or the <span class="guilabel">Attributes Toolbar</span></p></li>
<li><p><span class="guilabel">Field Filter</span> - allows the user to filter based on value of a field:
choose a column from a list, type or select a value and press <kbd class="kbd docutils literal notranslate">Enter</kbd> to filter.
Then, only the features matching <code class="docutils literal notranslate"><span class="pre">num_field</span> <span class="pre">=</span> <span class="pre">value</span></code> or <code class="docutils literal notranslate"><span class="pre">string_field</span> <span class="pre">ilike</span> <span class="pre">'%value%'</span></code>
expression are shown in the attribute table. You can check <a class="reference internal" href="../../../_images/checkbox.png"><img alt="checkbox" src="../../../_images/checkbox.png" style="width: 1.3em;" /></a>
<span class="guilabel">Case sensitive</span> to be less permissive with strings.</p></li>
<li><p><span class="guilabel">Advanced filter (Expression)</span> - Opens the expression builder
dialog. Within it, you can create <a class="reference internal" href="expression.html#vector-expressions"><span class="std std-ref">complex expressions</span></a> to match table rows.
For example, you can filter the table using more than one field.
When applied, the filter expression will show up at the bottom of the form.</p></li>
<li><p><span class="menuselection">Stored filter expressions ►</span>: a shortcut to <a class="reference internal" href="#store-filter"><span class="std std-ref">saved
expressions</span></a> frequently used for filtering your attribute table.</p></li>
</ul>
<p>It is also possible to <a class="reference internal" href="#filter-select-form"><span class="std std-ref">filter features using forms</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Filtering records out of the attribute table does not filter features out
of the layer; they are simply momentaneously hidden from the table and can be
accessed from the map canvas or by removing the filter. For filters that do
hide features from the layer, use the
<a class="reference internal" href="vector_properties.html#vector-query-builder"><span class="std std-ref">Query Builder</span></a>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Update datasource filtering with</strong> <code class="docutils literal notranslate"><span class="pre">Show</span> <span class="pre">Features</span> <span class="pre">Visible</span> <span class="pre">on</span> <span class="pre">Map</span></code></p>
<p>When for performance reasons, features shown in attribute table are spatially
limited to the canvas extent at its opening (see <a class="reference internal" href="../introduction/qgis_configuration.html#tip-table-filtering"><span class="std std-ref">Data Source Options</span></a> for a how-to), selecting <span class="guilabel">Show Features
Visible on Map</span> on a new canvas extent updates the spatial restriction.</p>
</div>
</section>
<section id="storing-filter-expressions">
<span id="store-filter"></span><span id="index-5"></span><h3><a class="toc-backref" href="#id33"><span class="section-number">14.4.3.3. </span>Storing filter expressions</a><a class="headerlink" href="#storing-filter-expressions" title="Permalink to this headline"></a></h3>
<p>Expressions you use for attribute table filtering can be saved for further calls.
When using <span class="guilabel">Field Filter</span> or <span class="guilabel">Advanced Filter (expression)</span>
entries, the expression used is displayed in a text widget in the bottom of the
attribute table dialog. Press the <a class="reference internal" href="../../../_images/mActionHandleStoreFilterExpressionUnchecked.png"><img alt="handleStoreFilterExpressionUnchecked" src="../../../_images/mActionHandleStoreFilterExpressionUnchecked.png" style="width: 1.5em;" /></a>
<sup>Save expression with text as name</sup> next to the box to save the expression
in the project. Pressing the drop-down menu next to the button allows to save
the expression with a custom name (<span class="guilabel">Save expression as…</span>).
Once a saved expression is displayed, the <a class="reference internal" href="../../../_images/mActionHandleStoreFilterExpressionChecked.png"><img alt="handleStoreFilterExpressionChecked" src="../../../_images/mActionHandleStoreFilterExpressionChecked.png" style="width: 1.5em;" /></a>
button is triggered and its drop-down menu allows you to <span class="guilabel">Edit the
expression</span> and name if any, or <span class="guilabel">Delete stored expression</span>.</p>
<p>Saved filter expressions are saved in the project and available through the
<span class="guilabel">Stored filter expressions</span> menu of the attribute table.
They are different from the <a class="reference internal" href="expression.html#user-expressions-functions"><span class="std std-ref">user expressions</span></a>,
shared by all projects of the active user profile.</p>
</section>
<section id="filtering-and-selecting-features-using-forms">
<span id="filter-select-form"></span><h3><a class="toc-backref" href="#id34"><span class="section-number">14.4.3.4. </span>Filtering and selecting features using forms</a><a class="headerlink" href="#filtering-and-selecting-features-using-forms" title="Permalink to this headline"></a></h3>
<p>Clicking the <a class="reference internal" href="../../../_images/mActionFilterMap.png"><img alt="filterMap" src="../../../_images/mActionFilterMap.png" style="width: 1.5em;" /></a> <sup>Filter/Select features using form</sup> or
pressing <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">F</kbd></kbd> will make the attribute table dialog switch to form view
and replace each widget with its search variant.</p>
<p>From this point onwards, this tool functionality is similar to the one described
in <a class="reference internal" href="../introduction/general_tools.html#select-by-value"><span class="std std-ref">Select Features By Value</span></a>, where you can find descriptions of all operators
and selecting modes.</p>
<figure class="align-center" id="id5">
<span id="figure-filter-select-form"></span><img alt="../../../_images/tableFilteredForm.png" src="../../../_images/tableFilteredForm.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.72 </span><span class="caption-text">Attribute table filtered by the filter form</span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>When selecting / filtering features from the attribute table, there is a <span class="guilabel">Filter features</span>
button that allows defining and refining filters. Its use triggers the
<span class="guilabel">Advanced filter (Expression)</span> option and displays the corresponding
filter expression in an editable text widget at the bottom of the form.</p>
<p>If there are already filtered features, you can refine the filter using the
drop-down list next to the <span class="guilabel">Filter features</span> button. The options are:</p>
<ul class="simple">
<li><p><span class="guilabel">Filter within (“AND”)</span></p></li>
<li><p><span class="guilabel">Extend filter (“OR”)</span></p></li>
</ul>
<p>To clear the filter, either select the <span class="guilabel">Show all features</span> option
from the bottom left pull-down menu, or clear the expression and
click <span class="guilabel">Apply</span> or press <kbd class="kbd docutils literal notranslate">Enter</kbd>.</p>
</section>
</section>
<section id="using-action-on-features">
<h2><a class="toc-backref" href="#id35"><span class="section-number">14.4.4. </span>Using action on features</a><a class="headerlink" href="#using-action-on-features" title="Permalink to this headline"></a></h2>
<p>Users have several possibilities to manipulate feature with the contextual menu
like:</p>
<ul class="simple">
<li><p><span class="guilabel">Select all</span> (<kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">A</kbd></kbd>) the features;</p></li>
<li><p>Copy the content of a cell in the clipboard with <span class="guilabel">Copy cell content</span>;</p></li>
<li><p><span class="guilabel">Zoom to feature</span> without having to select it beforehand;</p></li>
<li><p><span class="guilabel">Pan to feature</span> without having to select it beforehand;</p></li>
<li><p><span class="guilabel">Flash feature</span>, to highlight it in the map canvas;</p></li>
<li><p><span class="guilabel">Open form</span>: it toggles attribute table into form view with a focus
on the clicked feature.</p></li>
</ul>
<figure class="align-center" id="id6">
<span id="figure-copy-cell"></span><img alt="../../../_images/copyCellContent.png" src="../../../_images/copyCellContent.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.73 </span><span class="caption-text">Copy cell content button</span><a class="headerlink" href="#id6" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>If you want to use attribute data in external programs (such as Excel,
LibreOffice, QGIS or a custom web application), select one or more row(s) and
use the <a class="reference internal" href="../../../_images/mActionCopySelected.png"><img alt="copySelected" src="../../../_images/mActionCopySelected.png" style="width: 1.5em;" /></a> <sup>Copy selected rows to clipboard</sup> button or press
<kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">C</kbd></kbd>.</p>
<p id="geometry-format">In <span class="menuselection">Settings ► Options ► Data Sources</span> menu you can
define the format to paste to with <span class="guilabel">Copy features as</span> dropdown
list:</p>
<ul class="simple">
<li><p>Plain text, no geometry,</p></li>
<li><p>Plain text, WKT geometry,</p></li>
<li><p>GeoJSON</p></li>
</ul>
<p>You can also display a list of actions in this contextual menu. This is enabled
in the <span class="menuselection">Layer properties ► Actions</span> tab.
See <a class="reference internal" href="vector_properties.html#actions-menu"><span class="std std-ref">Actions Properties</span></a> for more information on actions.</p>
<section id="saving-selected-features-as-new-layer">
<h3><a class="toc-backref" href="#id36"><span class="section-number">14.4.4.1. </span>Saving selected features as new layer</a><a class="headerlink" href="#saving-selected-features-as-new-layer" title="Permalink to this headline"></a></h3>
<p>The selected features can be saved as any OGR-supported vector format and
also transformed into another coordinate reference system (CRS). In the
contextual menu of the layer, from the <span class="guilabel">Layers</span> panel, click on
<span class="menuselection">Export ► Save selected features as…</span> to define the name of
the output dataset, its format and CRS (see section <a class="reference internal" href="../managing_data_source/create_layers.html#general-saveas"><span class="std std-ref">Creating new layers from an existing layer</span></a>). You’ll
notice that <a class="reference internal" href="../../../_images/checkbox.png"><img alt="checkbox" src="../../../_images/checkbox.png" style="width: 1.3em;" /></a> <span class="menuselection">Save only selected features</span> is checked.
It is also possible to specify OGR creation options within the dialog.</p>
</section>
</section>
<section id="editing-attribute-values">
<span id="calculate-fields-values"></span><span id="index-6"></span><h2><a class="toc-backref" href="#id37"><span class="section-number">14.4.5. </span>Editing attribute values</a><a class="headerlink" href="#editing-attribute-values" title="Permalink to this headline"></a></h2>
<p>Editing attribute values can be done by:</p>
<ul class="simple">
<li><p>typing the new value directly in the cell, whether the attribute table is in
table or form view. Changes are hence done cell by cell, feature by feature;</p></li>
<li><p>using the <a class="reference internal" href="#vector-field-calculator"><span class="std std-ref">field calculator</span></a>: update in a row
a field that may already exist or to be created but for multiple features. It
can be used to create virtual fields;</p></li>
<li><p>using the quick field <a class="reference internal" href="#quick-field-calculation-bar"><span class="std std-ref">calculation bar</span></a>:
same as above but for only existing field;</p></li>
<li><p>or using the <a class="reference internal" href="#multi-edit-fields"><span class="std std-ref">multi edit</span></a> mode: update in a row
multiple fields for multiple features.</p></li>
</ul>
<section id="using-the-field-calculator">
<span id="vector-field-calculator"></span><h3><a class="toc-backref" href="#id38"><span class="section-number">14.4.5.1. </span>Using the Field Calculator</a><a class="headerlink" href="#using-the-field-calculator" title="Permalink to this headline"></a></h3>
<p>The <a class="reference internal" href="../../../_images/mActionCalculateField.png"><img alt="calculateField" src="../../../_images/mActionCalculateField.png" style="width: 1.5em;" /></a> <sup>Field Calculator</sup> button in the attribute table
allows you to perform calculations on the basis of existing attribute values or
defined functions, for instance, to calculate length or area of geometry
features. The results can be used to update an existing field, or written
to a new field (that can be a <a class="reference internal" href="#virtual-field"><span class="std std-ref">virtual</span></a> one).</p>
<p>The field calculator is available on any layer that supports edit.
When you click on the field calculator icon the dialog opens (see
<a class="reference internal" href="#figure-field-calculator"><span class="std std-numref">Fig. 14.74</span></a>). If the layer is not in edit mode, a warning is
displayed and using the field calculator will cause the layer to be put in
edit mode before the calculation is made.</p>
<p>Based on the <a class="reference internal" href="functions_list.html#functions-list"><span class="std std-ref">Expression Builder</span></a> dialog, the field
calculator dialog offers a complete interface to define an expression and apply
it to an existing or a newly created field.
To use the field calculator dialog, you must select whether you want to:</p>
<ol class="arabic simple">
<li><p>apply calculation on the whole layer or on selected features only</p></li>
<li><p>create a new field for the calculation or update an existing one.</p></li>
</ol>
<figure class="align-center" id="id7">
<span id="figure-field-calculator"></span><img alt="../../../_images/fieldcalculator.png" src="../../../_images/fieldcalculator.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.74 </span><span class="caption-text">Field Calculator</span><a class="headerlink" href="#id7" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>If you choose to add a new field, you need to enter a field name, a field type
(integer, real, date or string) and if needed, the total field length and the
field precision. For example, if you choose a field length of 10 and a field
precision of 3, it means you have 7 digits before the dot, and 3 digits for
the decimal part.</p>
<p>A short example illustrates how field calculator works when using the
<span class="guilabel">Expression</span> tab. We want to calculate the length in km of the
<code class="docutils literal notranslate"><span class="pre">railroads</span></code> layer from the QGIS sample dataset:</p>
<ol class="arabic simple">
<li><p>Load the shapefile <code class="file docutils literal notranslate"><span class="pre">railroads.shp</span></code> in QGIS and press <a class="reference internal" href="../../../_images/mActionOpenTable.png"><img alt="openTable" src="../../../_images/mActionOpenTable.png" style="width: 1.5em;" /></a>
<sup>Open Attribute Table</sup>.</p></li>
<li><p>Click on <a class="reference internal" href="../../../_images/mActionToggleEditing.png"><img alt="toggleEditing" src="../../../_images/mActionToggleEditing.png" style="width: 1.5em;" /></a> <sup>Toggle editing mode</sup> and open the
<a class="reference internal" href="../../../_images/mActionCalculateField.png"><img alt="calculateField" src="../../../_images/mActionCalculateField.png" style="width: 1.5em;" /></a> <sup>Field Calculator</sup> dialog.</p></li>
<li><p>Select the <a class="reference internal" href="../../../_images/checkbox.png"><img alt="checkbox" src="../../../_images/checkbox.png" style="width: 1.3em;" /></a> <span class="guilabel">Create a new field</span> checkbox to save the
calculations into a new field.</p></li>
<li><p>Set <span class="guilabel">Output field name</span> to  <code class="docutils literal notranslate"><span class="pre">length_km</span></code></p></li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">Decimal</span> <span class="pre">number</span> <span class="pre">(real)</span></code> as <span class="guilabel">Output field type</span></p></li>
<li><p>Set the <span class="guilabel">Output field length</span> to <code class="docutils literal notranslate"><span class="pre">10</span></code> and the <span class="guilabel">Precision</span>
to <code class="docutils literal notranslate"><span class="pre">3</span></code></p></li>
<li><p>Double click on <code class="docutils literal notranslate"><span class="pre">$length</span></code> in the <span class="guilabel">Geometry</span> group to add the length
of the geometry into the Field calculator expression box.</p></li>
<li><p>Complete the expression by typing <code class="docutils literal notranslate"><span class="pre">/</span> <span class="pre">1000</span></code> in the Field calculator
expression box and click <span class="guilabel">OK</span>.</p></li>
<li><p>You can now find a new <span class="guilabel">length_km</span> field in the attribute table.</p></li>
</ol>
</section>
<section id="creating-a-virtual-field">
<span id="virtual-field"></span><h3><a class="toc-backref" href="#id39"><span class="section-number">14.4.5.2. </span>Creating a Virtual Field</a><a class="headerlink" href="#creating-a-virtual-field" title="Permalink to this headline"></a></h3>
<p>A virtual field is a field based on an expression calculated on the fly, meaning
that its value is automatically updated as soon as an underlying parameter
changes. The expression is set once; you no longer need to recalculate the field
each time underlying values change.
For example, you may want to use a virtual field if you need area to be evaluated
as you digitize features or to automatically calculate a duration between dates
that may change (e.g., using <code class="docutils literal notranslate"><span class="pre">now()</span></code> function).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Use of Virtual Fields</strong></p>
<ul class="simple">
<li><p>Virtual fields are not permanent in the layer attributes, meaning that
they’re only saved and available in the project file they’ve been created.</p></li>
<li><p>A field can be set virtual only at its creation.
Virtual fields are marked with a purple background in the fields tab of
the layer properties dialog to distinguish them from regular physical
or joined fields. Their expression can be edited later by pressing the
expression button in the Comment column. An expression editor window will
be opened to adjust the expression of the virtual field.</p></li>
</ul>
</div>
</section>
<section id="using-the-quick-field-calculation-bar">
<span id="quick-field-calculation-bar"></span><h3><a class="toc-backref" href="#id40"><span class="section-number">14.4.5.3. </span>Using the Quick Field Calculation Bar</a><a class="headerlink" href="#using-the-quick-field-calculation-bar" title="Permalink to this headline"></a></h3>
<p>While Field calculator is always available, the quick field calculation bar on
top of the attribute table is only visible if the layer is in edit mode. Thanks
to the expression engine, it offers a quicker access to edit an already existing
field:</p>
<ol class="arabic simple">
<li><p>Select the field to update in the drop-down list.</p></li>
<li><p>Fill the textbox with a value, an expression you directly write or build using the
<a class="reference internal" href="../../../_images/mIconExpression.png"><img alt="expression" src="../../../_images/mIconExpression.png" style="width: 1.5em;" /></a> expression button.</p></li>
<li><p>Click on <span class="guilabel">Update All</span>, <span class="guilabel">Update Selected</span> or
<span class="guilabel">Update Filtered</span> button according to your need.</p></li>
</ol>
<figure class="align-center" id="id8">
<span id="figure-field-calculator-bar"></span><img alt="../../../_images/fieldcalculatorbar.png" src="../../../_images/fieldcalculatorbar.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.75 </span><span class="caption-text">Quick Field Calculation Bar</span><a class="headerlink" href="#id8" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="editing-multiple-fields">
<span id="multi-edit-fields"></span><span id="index-7"></span><h3><a class="toc-backref" href="#id41"><span class="section-number">14.4.5.4. </span>Editing multiple fields</a><a class="headerlink" href="#editing-multiple-fields" title="Permalink to this headline"></a></h3>
<p>Unlike the previous tools, multi edit mode allows multiple attributes of
different features to be edited simultaneously. When the layer is toggled to
edit, multi edit capabilities are accessible:</p>
<ul class="simple">
<li><p>using the <a class="reference internal" href="../../../_images/mActionMultiEdit.png"><img alt="multiEdit" src="../../../_images/mActionMultiEdit.png" style="width: 1.5em;" /></a> <sup>Toggle multi edit mode</sup> button from the toolbar
inside the attribute table dialog;</p></li>
<li><p>or selecting <span class="menuselection">Edit ►</span> <a class="reference internal" href="../../../_images/mActionMultiEdit.png"><img alt="multiEdit" src="../../../_images/mActionMultiEdit.png" style="width: 1.5em;" /></a> <span class="menuselection">Modify
attributes of selected features</span> menu.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike the tool from the attribute table, hitting the <span class="menuselection">Edit
► Modify Attributes of Selected Features</span> option provides you with a modal
dialog to fill attributes changes. Hence, features selection is required
before execution.</p>
</div>
<p>In order to edit multiple fields in a row:</p>
<ol class="arabic">
<li><p>Select the features you want to edit.</p></li>
<li><p>From the attribute table toolbar, click the <a class="reference internal" href="../../../_images/mActionMultiEdit.png"><img alt="multiEdit" src="../../../_images/mActionMultiEdit.png" style="width: 1.5em;" /></a> button. This will
toggle the dialog to its form view. Feature selection could also be made
at this step.</p></li>
<li><p>At the right side of the attribute table, fields (and values) of selected
features are shown. New widgets appear next to each field allowing for
display of the current multi edit state:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../_images/multieditMixedValues.png"><img alt="multiEditMixedValues" src="../../../_images/multieditMixedValues.png" style="width: 1.5em;" /></a> The field contains different values for selected
features. It’s shown empty and each feature will keep its original value.
You can reset the value of the field from the drop-down list of the widget.</p></li>
<li><p><a class="reference internal" href="../../../_images/multieditSameValues.png"><img alt="multiEditSameValues" src="../../../_images/multieditSameValues.png" style="width: 1.5em;" /></a> All selected features have the same value for this
field and the value displayed in the form will be kept.</p></li>
<li><p><a class="reference internal" href="../../../_images/multieditChangedValues.png"><img alt="multiEditChangedValues" src="../../../_images/multieditChangedValues.png" style="width: 1.5em;" /></a> The field has been edited and the entered value
will be applied to all the selected features. A message appears at the top
of the dialog, inviting you to either apply or reset your modification.</p></li>
</ul>
<p>Clicking any of these widgets allows you to either set the current value for
the field or reset to original value, meaning that you can roll back changes
on a field-by-field basis.</p>
<figure class="align-center" id="id9">
<span id="figure-field-multiedit"></span><img alt="../../../_images/attribute_multiedit.png" src="../../../_images/attribute_multiedit.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.76 </span><span class="caption-text">Editing fields of multiple features</span><a class="headerlink" href="#id9" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</li>
<li><p>Make the changes to the fields you want.</p></li>
<li><p>Click on <strong>Apply changes</strong> in the upper message text or any other feature
in the left panel.</p></li>
</ol>
<p>Changes will apply to <strong>all selected features</strong>. If no feature is selected, the
whole table is updated with your changes. Modifications are made as a single
edit command. So pressing <a class="reference internal" href="../../../_images/mActionUndo.png"><img alt="undo" src="../../../_images/mActionUndo.png" style="width: 1.5em;" /></a> <sup>Undo</sup> will rollback the attribute
changes for all selected features at once.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multi edit mode is only available for auto generated and drag and drop forms
(see <a class="reference internal" href="vector_properties.html#customize-form"><span class="std std-ref">Customizing a form for your data</span></a>); it is not supported by custom ui forms.</p>
</div>
</section>
</section>
<section id="creating-one-or-many-to-many-relations">
<span id="vector-relations"></span><span id="index-8"></span><h2><a class="toc-backref" href="#id42"><span class="section-number">14.4.6. </span>Creating one or many to many relations</a><a class="headerlink" href="#creating-one-or-many-to-many-relations" title="Permalink to this headline"></a></h2>
<p>Relations are a technique often used in databases. The concept is that
features (rows) of different layers (tables) can belong to each other.</p>
<section id="introducing-1-n-relations">
<span id="one-to-many-relation"></span><h3><a class="toc-backref" href="#id43"><span class="section-number">14.4.6.1. </span>Introducing 1-N relations</a><a class="headerlink" href="#introducing-1-n-relations" title="Permalink to this headline"></a></h3>
<p>As an example you have a layer with all regions of alaska (polygon)
which provides some attributes about its name and region type and a
unique id (which acts as primary key).</p>
<p>Then you get another point layer or table with information about airports
that are located in the regions and you also want to keep track of these. If
you want to add them to the regions layer, you need to create a one to many
relation using foreign keys, because there are several airports in most regions.</p>
<figure class="align-center" id="id10">
<span id="figure-relations-map"></span><img alt="../../../_images/relations1.png" src="../../../_images/relations1.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.77 </span><span class="caption-text">Alaska region with airports</span><a class="headerlink" href="#id10" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<section id="layers-in-1-n-relations">
<h4><a class="toc-backref" href="#id44"><span class="section-number">14.4.6.1.1. </span>Layers in 1-N relations</a><a class="headerlink" href="#layers-in-1-n-relations" title="Permalink to this headline"></a></h4>
<p>QGIS makes no difference between a table and a vector layer. Basically, a vector
layer is a table with a geometry. So you can add your table as a vector layer.
To demonstrate the 1-n relation, you can load the <code class="file docutils literal notranslate"><span class="pre">regions</span></code> shapefile and
the <code class="file docutils literal notranslate"><span class="pre">airports</span></code> shapefile which has a foreign key field (<code class="docutils literal notranslate"><span class="pre">fk_region</span></code>) to
the layer regions. This means, that each airport belongs to exactly one region
while each region can have any number of airports (a typical one to many
relation).</p>
</section>
<section id="foreign-keys-in-1-n-relations">
<h4><a class="toc-backref" href="#id45"><span class="section-number">14.4.6.1.2. </span>Foreign keys in 1-N relations</a><a class="headerlink" href="#foreign-keys-in-1-n-relations" title="Permalink to this headline"></a></h4>
<p>In addition to the already existing attributes in the airports attribute table,
you’ll need another field <code class="docutils literal notranslate"><span class="pre">fk_region</span></code> which acts as a foreign key (if you have
a database, you will probably want to define a constraint on it).</p>
<p>This field fk_region will always contain an id of a region. It can be seen like
a pointer to the region it belongs to. And you can design a custom edit form
for editing and QGIS takes care of the setup. It works with different
providers (so you can also use it with shape and csv files) and all you have
to do is to tell QGIS the relations between your tables.</p>
</section>
<section id="defining-1-n-relations">
<h4><a class="toc-backref" href="#id46"><span class="section-number">14.4.6.1.3. </span>Defining 1-N relations</a><a class="headerlink" href="#defining-1-n-relations" title="Permalink to this headline"></a></h4>
<p>The first thing we are going to do is to let QGIS know about the relations
between the layers. This is done in <span class="menuselection">Project ► Properties…</span>.
Open the <span class="guilabel">Relations</span> tab and click on <a class="reference internal" href="../../../_images/symbologyAdd.png"><img alt="signPlus" src="../../../_images/symbologyAdd.png" style="width: 1.5em;" /></a> <span class="guilabel">Add Relation</span>.</p>
<ul>
<li><p><strong>Name</strong> is going to be used as a title. It should be a human readable string,
describing, what the relation is used for. We will just call say <strong>airport_relation</strong>
in this case.</p></li>
<li><p><strong>Referenced Layer (Parent)</strong> also considered as parent layer, is the one with
the primary key, pointed to, so here it is the <code class="docutils literal notranslate"><span class="pre">regions</span></code> layer. You need to define
the primary key of the referenced layer, so it is <code class="docutils literal notranslate"><span class="pre">ID</span></code>.</p></li>
<li><p><strong>Referencing Layer (Child)</strong> also considered as child layer, is the one with
the foreign key field on it. In our case, this is the <code class="docutils literal notranslate"><span class="pre">airports</span></code> layer. For
this layer you need to add a referencing field which points to the other
layer, so this is <code class="docutils literal notranslate"><span class="pre">fk_region</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sometimes, you need more than a single field to uniquely identify
features in a layer. Creating a relation with such a layer requires
a <strong>composite key</strong>, ie more than a single pair of matching
fields. Use the <a class="reference internal" href="../../../_images/symbologyAdd.png"><img alt="signPlus" src="../../../_images/symbologyAdd.png" style="width: 1.5em;" /></a> <sup>Add new field pair as part of a composite
foreign key</sup> button to add as many pairs as necessary.</p>
</div>
</li>
<li><p><strong>Id</strong> will be used for internal purposes and has to be unique. You may need
it to build <a class="reference internal" href="vector_properties.html#customize-form"><span class="std std-ref">custom forms</span></a>. If
you leave it empty, one will be generated for you but you can assign one
yourself to get one that is easier to handle</p></li>
<li><p><strong>Relationship strength</strong> sets the strength of the relation between the parent
and the child layer. The default <span class="guilabel">Association</span> type means that
the parent layer is <em>simply</em> linked to the child one while the
<span class="guilabel">Composition</span> type allows you to duplicate also the child features
when duplicating the parent ones.</p></li>
</ul>
<figure class="align-center" id="id11">
<span id="figure-relations-manager"></span><img alt="../../../_images/relations2.png" src="../../../_images/relations2.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.78 </span><span class="caption-text">Adding a relation between regions and airports layers</span><a class="headerlink" href="#id11" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>From the <span class="guilabel">Relations</span> tab, you can also press the <a class="reference internal" href="../../../_images/symbologyAdd.png"><img alt="signPlus" src="../../../_images/symbologyAdd.png" style="width: 1.5em;" /></a>
<span class="guilabel">Discover Relation</span> button to fetch the relations available from
the providers of the loaded layers. This is possible for layers stored in
data providers like PostgreSQL or SpatiaLite.</p>
</section>
<section id="forms-for-1-n-relations">
<span id="index-9"></span><h4><a class="toc-backref" href="#id47"><span class="section-number">14.4.6.1.4. </span>Forms for 1-N relations</a><a class="headerlink" href="#forms-for-1-n-relations" title="Permalink to this headline"></a></h4>
<p>Now that QGIS knows about the relation, it will be used to improve the
forms it generates. As we did not change the default form method (autogenerated)
it will just add a new widget in our form. So let’s select the layer region in
the legend and use the identify tool. Depending on your settings, the form might
open directly or you will have to choose to open it in the identification dialog
under actions.</p>
<figure class="align-center" id="id12">
<span id="figure-embedded-form"></span><img alt="../../../_images/relations3.png" src="../../../_images/relations3.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.79 </span><span class="caption-text">Identification dialog regions with relation to airports</span><a class="headerlink" href="#id12" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>As you can see, the airports assigned to this particular region are all shown in
a table. And there are also some buttons available. Let’s review them shortly:</p>
<ul class="simple">
<li><p>The <a class="reference internal" href="../../../_images/mActionToggleEditing.png"><img alt="toggleEditing" src="../../../_images/mActionToggleEditing.png" style="width: 1.5em;" /></a> button is for toggling the edit mode. Be aware that it
toggles the edit mode of the airport layer, although we are in the feature
form of a feature from the region layer. But the table is representing
features of the airport layer.</p></li>
<li><p>The <a class="reference internal" href="../../../_images/mActionSaveEdits.png"><img alt="saveEdits" src="../../../_images/mActionSaveEdits.png" style="width: 1.5em;" /></a> button is for saving all the edits.</p></li>
<li><p>The <a class="reference internal" href="../../../_images/mActionNewTableRow.png"><img alt="newTableRow" src="../../../_images/mActionNewTableRow.png" style="width: 1.5em;" /></a> button will add a new record to the airport layer attribute table.
And it will assign the new airport to the current region by default.</p></li>
<li><p>The <a class="reference internal" href="../../../_images/mActionCapturePoint.png"><img alt="capturePoint" src="../../../_images/mActionCapturePoint.png" style="width: 1.5em;" /></a> is the same as <a class="reference internal" href="../../../_images/mActionNewTableRow.png"><img alt="newTableRow" src="../../../_images/mActionNewTableRow.png" style="width: 1.5em;" /></a> but lets you digitize the
airport geometry in the map canvas beforehand. Note that the icon will change according
to geometry type.</p></li>
<li><p>The <a class="reference internal" href="../../../_images/mActionDuplicateFeature.png"><img alt="duplicateFeature" src="../../../_images/mActionDuplicateFeature.png" style="width: 1.5em;" /></a> button allows you to copy one or more child features.</p></li>
<li><p>The <a class="reference internal" href="../../../_images/mActionDeleteSelectedFeatures.png"><img alt="deleteSelectedFeatures" src="../../../_images/mActionDeleteSelectedFeatures.png" style="width: 1.5em;" /></a> button will delete the selected airport
permanently.</p></li>
<li><p>The <a class="reference internal" href="../../../_images/mActionLink.png"><img alt="link" src="../../../_images/mActionLink.png" style="width: 1.5em;" /></a> symbol will open a new dialog where you can select any existing
airport which will then be assigned to the current region. This may be handy
if you created the airport on the wrong region by accident.</p></li>
<li><p>The <a class="reference internal" href="../../../_images/mActionUnlink.png"><img alt="unlink" src="../../../_images/mActionUnlink.png" style="width: 1.5em;" /></a> symbol will unlink the selected airport from the current region,
leaving them unassigned (the foreign key is set to NULL) effectively.</p></li>
<li><p>With the <a class="reference internal" href="../../../_images/mActionZoomToSelected.png"><img alt="zoomToSelected" src="../../../_images/mActionZoomToSelected.png" style="width: 1.5em;" /></a> button you can zoom the map to the selected child
features.</p></li>
<li><p>The two buttons <a class="reference internal" href="../../../_images/mActionFormView.png"><img alt="formView" src="../../../_images/mActionFormView.png" style="width: 1.2em;" /></a> and <a class="reference internal" href="../../../_images/mActionOpenTable.png"><img alt="openTable" src="../../../_images/mActionOpenTable.png" style="width: 1.5em;" /></a> to the right switch between table
view and form view where the later let’s you view all the airports in their
respective form.</p></li>
</ul>
<p>In the above example the referencing layer has geometries (so it isn’t just
an alphanumeric table) so the above steps will create an entry in the layer
attribute table that has no corresponding geometric feature. To add the
geometry:</p>
<ol class="arabic simple">
<li><p>Choose <a class="reference internal" href="../../../_images/mActionOpenTable.png"><img alt="openTable" src="../../../_images/mActionOpenTable.png" style="width: 1.5em;" /></a> <span class="menuselection">Open Attribute Table</span> for the referencing layer.</p></li>
<li><p>Select the record that has been added previously within the feature form of the
referenced layer.</p></li>
<li><p>Use the <a class="reference internal" href="../../../_images/mActionAddPart.png"><img alt="addPart" src="../../../_images/mActionAddPart.png" style="width: 1.5em;" /></a> <sup>Add Part</sup> digitizing tool to attach a geometry to the
selected attributes table record.</p></li>
</ol>
<p>If you work on the airport table, the widget Relation Reference is automatically
set up for the <code class="docutils literal notranslate"><span class="pre">fk_region</span></code> field (the one used to create the relation), see
<a class="reference internal" href="vector_properties.html#configure-field"><span class="std std-ref">Relation Reference widget</span></a>.</p>
<p>In the airport form you will see the <a class="reference internal" href="../../../_images/mActionFormView.png"><img alt="formView" src="../../../_images/mActionFormView.png" style="width: 1.2em;" /></a> button at the right side of the
<code class="docutils literal notranslate"><span class="pre">fk_region</span></code> field: if you click on the button the form of the region layer will
be opened. This widget allows you to easily and quickly open the forms of the
linked parent features.</p>
<figure class="align-center" id="id13">
<span id="figure-linked-forms"></span><img alt="../../../_images/relations4.png" src="../../../_images/relations4.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.80 </span><span class="caption-text">Identification dialog airport with relation to regions</span><a class="headerlink" href="#id13" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The Relation Reference widget has also an option to embed the form of the parent
layer within the child one. It is available in  the <span class="menuselection">Properties ► Attributes Form</span>
menu of the airport layer: select the <code class="docutils literal notranslate"><span class="pre">fk_region</span></code> field and check the
<code class="docutils literal notranslate"><span class="pre">Show</span> <span class="pre">embedded</span> <span class="pre">form</span></code> option.</p>
<p>If you look at the feature dialog now, you will see, that the form of the region
is embedded inside the airports form and will even have a combobox, which allows
you to assign the current airport to another region.</p>
<figure class="align-center" id="figure-linked-forms-embedded">
<img alt="../../../_images/relations5.png" src="../../../_images/relations5.png" />
</figure>
<p>Moreover if you toggle the editing mode of the airport layer, the <code class="docutils literal notranslate"><span class="pre">fk_region</span></code>
field has also an autocompleter function: while typing you will see all the
values of the <code class="docutils literal notranslate"><span class="pre">id</span></code> field of the region layer.
Here it is possible to digitize a polygon for the region layer using the <a class="reference internal" href="../../../_images/symbologyAdd.png"><img alt="signPlus" src="../../../_images/symbologyAdd.png" style="width: 1.5em;" /></a> button
if you chose the option <code class="docutils literal notranslate"><span class="pre">Allow</span> <span class="pre">adding</span> <span class="pre">new</span> <span class="pre">features</span></code> in the
<span class="menuselection">Properties ► Attributes Form</span> menu of the airport layer.</p>
<p>The child layer can also be used in the <a class="reference internal" href="../introduction/general_tools.html#select-by-value"><span class="std std-ref">Select Features By Value</span></a> tool in
order to select features of the parent layer based on attributes of their children.</p>
<p>In <a class="reference internal" href="#figure-select-by-value"><span class="std std-numref">Fig. 14.81</span></a>, all the regions where the mean
altitude of the airports is greater than 500 meters above sea level
are selected.</p>
<p>You will find that many different aggregation functions are available in the form.</p>
<figure class="align-center" id="id14">
<span id="figure-select-by-value"></span><img alt="../../../_images/relation_select_by_value.png" src="../../../_images/relation_select_by_value.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.81 </span><span class="caption-text">Select parent features with child values</span><a class="headerlink" href="#id14" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="introducing-many-to-many-n-m-relations">
<span id="many-to-many-relation"></span><span id="index-10"></span><h3><a class="toc-backref" href="#id48"><span class="section-number">14.4.6.2. </span>Introducing many-to-many (N-M) relations</a><a class="headerlink" href="#introducing-many-to-many-n-m-relations" title="Permalink to this headline"></a></h3>
<p>N-M relations are many-to-many relations between two tables. For instance, the
<code class="docutils literal notranslate"><span class="pre">airports</span></code> and <code class="docutils literal notranslate"><span class="pre">airlines</span></code> layers: an airport receives several airline
companies and an airline company flies to several airports.</p>
<p>This SQL code creates the three tables we need for an N-M relationship in
a PostgreSQL/PostGIS schema named <em>locations</em>. You can run the code using the
<span class="menuselection">Database ► DB Manager…</span> for PostGIS or external tools such as <a class="reference external" href="https://www.pgadmin.org">pgAdmin</a>. The airports table stores the <code class="docutils literal notranslate"><span class="pre">airports</span></code> layer and the airlines
table stores the <code class="docutils literal notranslate"><span class="pre">airlines</span></code> layer. In both tables few fields are used for
clarity. The <em>tricky</em> part is the <code class="docutils literal notranslate"><span class="pre">airports_airlines</span></code> table. We need it to list all
airlines for all airports (or vice versa). This kind of table is known
as a <em>pivot table</em>. The <em>constraints</em> in this table force that an airport can be
associated with an airline only if both already exist in their layers.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">SCHEMA</span> <span class="n">locations</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">locations</span><span class="p">.</span><span class="n">airports</span>
<span class="p">(</span>
   <span class="n">id</span> <span class="nb">serial</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">geom</span> <span class="n">geometry</span><span class="p">(</span><span class="n">Point</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">airport_name</span> <span class="nb">text</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="k">CONSTRAINT</span> <span class="n">airports_pkey</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">airports_geom_idx</span> <span class="k">ON</span> <span class="n">locations</span><span class="p">.</span><span class="n">airports</span> <span class="k">USING</span> <span class="n">gist</span> <span class="p">(</span><span class="n">geom</span><span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">locations</span><span class="p">.</span><span class="n">airlines</span>
<span class="p">(</span>
   <span class="n">id</span> <span class="nb">serial</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">geom</span> <span class="n">geometry</span><span class="p">(</span><span class="n">Point</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">airline_name</span> <span class="nb">text</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="k">CONSTRAINT</span> <span class="n">airlines_pkey</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">airlines_geom_idx</span> <span class="k">ON</span> <span class="n">locations</span><span class="p">.</span><span class="n">airlines</span> <span class="k">USING</span> <span class="n">gist</span> <span class="p">(</span><span class="n">geom</span><span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">locations</span><span class="p">.</span><span class="n">airports_airlines</span>
<span class="p">(</span>
   <span class="n">id</span> <span class="nb">serial</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">airport_fk</span> <span class="nb">integer</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">airline_fk</span> <span class="nb">integer</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="k">CONSTRAINT</span> <span class="n">airports_airlines_pkey</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">id</span><span class="p">),</span>
   <span class="k">CONSTRAINT</span> <span class="n">airports_airlines_airport_fk_fkey</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">airport_fk</span><span class="p">)</span>
      <span class="k">REFERENCES</span> <span class="n">locations</span><span class="p">.</span><span class="n">airports</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
      <span class="k">ON</span> <span class="k">DELETE</span> <span class="k">CASCADE</span>
      <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CASCADE</span>
      <span class="k">DEFERRABLE</span> <span class="k">INITIALLY</span> <span class="k">DEFERRED</span><span class="p">,</span>
   <span class="k">CONSTRAINT</span> <span class="n">airports_airlines_airline_fk_fkey</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">airline_fk</span><span class="p">)</span>
      <span class="k">REFERENCES</span> <span class="n">locations</span><span class="p">.</span><span class="n">airlines</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
      <span class="k">ON</span> <span class="k">DELETE</span> <span class="k">CASCADE</span>
      <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CASCADE</span>
      <span class="k">DEFERRABLE</span> <span class="k">INITIALLY</span> <span class="k">DEFERRED</span>
 <span class="p">);</span>
</pre></div>
</div>
<p>Instead of PostgreSQL you can also use GeoPackage. In this case, the three tables
can be created manually using the <span class="menuselection">Database ► DB Manager…</span>. In
GeoPackage there are no schemas so the <em>locations</em> prefix is not needed.</p>
<p>Foreign key constraints in <code class="docutils literal notranslate"><span class="pre">airports_airlines</span></code> table can´t be created using <span class="menuselection">Table ► Create Table…</span>
or <span class="menuselection">Table ► Edit Table…</span> so they should be created using <span class="menuselection">Database ► SQL Window…</span>.
GeoPackage doesn’t support <em>ADD CONSTRAINT</em> statements so the <code class="docutils literal notranslate"><span class="pre">airports_airlines</span></code>
table should be created in two steps:</p>
<ol class="arabic">
<li><p>Set up the table only with the <code class="docutils literal notranslate"><span class="pre">id</span></code> field using <span class="menuselection">Table ► Create Table…</span></p></li>
<li><p>Using <span class="menuselection">Database ► SQL Window…</span>, type and execute this SQL code:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">airports_airlines</span>
   <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">airport_fk</span> <span class="nb">INTEGER</span>
   <span class="k">REFERENCES</span> <span class="n">airports</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
   <span class="k">ON</span> <span class="k">DELETE</span> <span class="k">CASCADE</span>
   <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CASCADE</span>
   <span class="k">DEFERRABLE</span> <span class="k">INITIALLY</span> <span class="k">DEFERRED</span><span class="p">;</span>

<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">airports_airlines</span>
   <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">airline_fk</span> <span class="nb">INTEGER</span>
   <span class="k">REFERENCES</span> <span class="n">airlines</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
   <span class="k">ON</span> <span class="k">DELETE</span> <span class="k">CASCADE</span>
   <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CASCADE</span>
   <span class="k">DEFERRABLE</span> <span class="k">INITIALLY</span> <span class="k">DEFERRED</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ol>
<p>Then in QGIS, you should set up two <a class="reference internal" href="#one-to-many-relation"><span class="std std-ref">one-to-many relations</span></a>
as explained above:</p>
<ul class="simple">
<li><p>a relation between <code class="docutils literal notranslate"><span class="pre">airlines</span></code> table and the pivot table;</p></li>
<li><p>and a second one between <code class="docutils literal notranslate"><span class="pre">airports</span></code> table and the pivot table.</p></li>
</ul>
<p>An easier way to do it (only for PostgreSQL) is using the <span class="guilabel">Discover Relations</span>
in <span class="menuselection">Project ► Properties ► Relations</span>. QGIS will automatically read
all relations in your database and you only have to select the two you need. Remember
to load the three tables in the QGIS project first.</p>
<figure class="align-center" id="id15">
<span id="figure-setup-relations"></span><img alt="../../../_images/relations6.png" src="../../../_images/relations6.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.82 </span><span class="caption-text">Relations and autodiscover</span><a class="headerlink" href="#id15" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>In case you want to remove an <code class="docutils literal notranslate"><span class="pre">airport</span></code> or an <code class="docutils literal notranslate"><span class="pre">airline</span></code>, QGIS won’t remove
the associated record(s) in <code class="docutils literal notranslate"><span class="pre">airports_airlines</span></code> table. This task will be made by
the database if we specify the right <em>constraints</em> in the pivot table creation as
in the current example.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Combining N-M relation with automatic transaction group</strong></p>
<p>You should enable the transaction mode in <span class="menuselection">Project Properties
► Data Sources ►</span> when working on such context. QGIS should be able to
add or update row(s) in all tables (airlines, airports and the pivot tables).</p>
</div>
<p>Finally we have to select the right cardinalilty in the
<span class="menuselection">Layer Properties ► Attributes Form</span> for the <code class="docutils literal notranslate"><span class="pre">airports</span></code> and
<code class="docutils literal notranslate"><span class="pre">airlines</span></code> layers. For the first one we should choose the <strong>airlines (id)</strong> option
and for the second one the <strong>airports (id)</strong> option.</p>
<figure class="align-center" id="id16">
<span id="figure-cardinality"></span><img alt="../../../_images/relations7.png" src="../../../_images/relations7.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.83 </span><span class="caption-text">Set relationship cardinality</span><a class="headerlink" href="#id16" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Now you can associate an airport with an airline (or an airline with an airport)
using <span class="guilabel">Add child feature</span> or <span class="guilabel">Link existing child feature</span>
in the subforms. A record will automatically be inserted in the <code class="docutils literal notranslate"><span class="pre">airports_airlines</span></code>
table.</p>
<figure class="align-center" id="id17">
<span id="figure-relationship-working"></span><img alt="../../../_images/relations8.png" src="../../../_images/relations8.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.84 </span><span class="caption-text">N-M relationship between airports and airlines</span><a class="headerlink" href="#id17" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using <strong>Many to one relation</strong> cardinality</p>
<p>Sometimes hiding the pivot table in an N-M relationship is not
desirable. Mainly because there are attributes in the relationship that can only
have values when a relationship is established. If your tables are layers (have
a geometry field) it could be interesting to activate the <span class="guilabel">On map identification</span>
option (<span class="menuselection">Layer Properties ► Attributes Form ► Available widgets ► Fields</span>)
for the foreign key fields in the pivot table.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Pivot table primary key</strong></p>
<p>Avoid using multiple fields in the primary key in a pivot table. QGIS assumes a single
primary key so a constraint like <code class="docutils literal notranslate"><span class="pre">constraint</span> <span class="pre">airports_airlines_pkey</span> <span class="pre">primary</span> <span class="pre">key</span> <span class="pre">(airport_fk,</span> <span class="pre">airline_fk)</span></code>
will not work.</p>
</div>
</section>
<section id="introducing-polymorphic-relations">
<span id="polymorphic-relation"></span><span id="index-11"></span><h3><a class="toc-backref" href="#id49"><span class="section-number">14.4.6.3. </span>Introducing polymorphic relations</a><a class="headerlink" href="#introducing-polymorphic-relations" title="Permalink to this headline"></a></h3>
<p>Polymorphic relations are special case of 1-N relations, where a single referencing (document) layer contains
the features for multiple referenced layers. This differs from normal relations which require different
referencing layer for each referenced layer. A single referencing (document) layer is achieved by adding an adiditonal
<code class="docutils literal notranslate"><span class="pre">layer_field</span></code> column in the referencing (document) layer that stores information to identify the referenced layer. In
its most simple form, the referencing (document) layer will just insert the layer name of the referenced layer into
this field.</p>
<p>To be more precise, a polymorphic relation is a set of normal relations having the same referencing
layer but having the referenced layer dynamically defined. The polymorphic setting of the layer is solved by using
an expression which has to match some properties of the referenced layer like the table name, layer id, layer name.</p>
<p>Imagine we are going to the park and want to take pictures of different species of <code class="docutils literal notranslate"><span class="pre">plants</span></code> and <code class="docutils literal notranslate"><span class="pre">animals</span></code>
we see there. Each plant or animal has multiple pictures associated with it, so if we use the normal 1:N
relations to store pictures, we would need two separate tables, <code class="docutils literal notranslate"><span class="pre">animal_images</span></code> and <code class="docutils literal notranslate"><span class="pre">plant_images</span></code>.
This might not be a problem for 2 tables, but imagine if we want to take separate pictures for mushrooms, birds etc.</p>
<p>Polymorphic relations solve this problem as all the referencing features are stored in the same table <code class="docutils literal notranslate"><span class="pre">documents</span></code>.
For each feature the referenced layer is stored in the <code class="docutils literal notranslate"><span class="pre">referenced_layer</span></code> field and the referenced
feature id in the <code class="docutils literal notranslate"><span class="pre">referenced_fk</span></code>.</p>
<section id="defining-polymorphic-relations">
<h4><a class="toc-backref" href="#id50"><span class="section-number">14.4.6.3.1. </span>Defining polymorphic relations</a><a class="headerlink" href="#defining-polymorphic-relations" title="Permalink to this headline"></a></h4>
<p>First, let QGIS know about the polymorphic relations between the layers. This is
done in <span class="menuselection">Project ► Properties…</span>.
Open the <span class="guilabel">Relations</span> tab and click on the little down arrow next to the <a class="reference internal" href="../../../_images/symbologyAdd.png"><img alt="signPlus" src="../../../_images/symbologyAdd.png" style="width: 1.5em;" /></a>
<span class="guilabel">Add Relation</span> button, so you can select the <span class="guilabel">Add Polymorphic Relation</span> option
from the newly appeared dropdown.</p>
<figure class="align-center" id="id18">
<span id="figure-define-polymorphic-relation"></span><img alt="../../../_images/relations9.png" src="../../../_images/relations9.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.85 </span><span class="caption-text">Adding a polymorphic relation using <code class="docutils literal notranslate"><span class="pre">documents</span></code> layer as referencing and <code class="docutils literal notranslate"><span class="pre">animals</span></code> and <code class="docutils literal notranslate"><span class="pre">plants</span></code> as referenced layers.</span><a class="headerlink" href="#id18" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<ul>
<li><p><strong>Id</strong> will be used for internal purposes and has to be unique. You may need
it to build <a class="reference internal" href="vector_properties.html#customize-form"><span class="std std-ref">custom forms</span></a>. If
you leave it empty, one will be generated for you but you can assign one
yourself to get one that is easier to handle</p></li>
<li><p><strong>Referencing Layer (Child)</strong> also considered as child layer, is the one with
the foreign key field on it. In our case, this is the <code class="docutils literal notranslate"><span class="pre">documents</span></code> layer. For
this layer you need to add a referencing field which points to the other
layer, so this is <code class="docutils literal notranslate"><span class="pre">referenced_fk</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sometimes, you need more than a single field to uniquely identify
features in a layer. Creating a relation with such a layer requires
a <strong>composite key</strong>, ie more than a single pair of matching
fields. Use the <a class="reference internal" href="../../../_images/symbologyAdd.png"><img alt="signPlus" src="../../../_images/symbologyAdd.png" style="width: 1.5em;" /></a> <sup>Add new field pair as part of a composite
foreign key</sup> button to add as many pairs as necessary.</p>
</div>
</li>
<li><dl class="simple">
<dt><strong>Layer Field</strong> is the field in the referencing table that stores the result of the evaluated</dt><dd><p>layer expression which is the referencing table that this feature belongs to. In our example,
this would be the <code class="docutils literal notranslate"><span class="pre">referenced_layer</span></code> field.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Layer expression</strong> evaluates to a unique identifier of the layer. This can be the layer name</dt><dd><p><code class="docutils literal notranslate"><span class="pre">&#64;layer_name</span></code>, the layer id <code class="docutils literal notranslate"><span class="pre">&#64;layer_id</span></code>, the layer’s table name <code class="docutils literal notranslate"><span class="pre">decode_uri(&#64;layer,</span> <span class="pre">'table')</span></code>
or anything that can uniquely identifies a layer.</p>
</dd>
</dl>
</li>
<li><p><strong>Relationship strength</strong> sets the strength of the generated relations between the parent
and the child layer. The default <span class="guilabel">Association</span> type means that
the parent layer is <em>simply</em> linked to the child one while the
<span class="guilabel">Composition</span> type allows you to duplicate also the child features
when duplicating the parent ones.</p></li>
<li><p><strong>Referenced Layers</strong> also considered as parent layers, are those with
the primary key, pointed to, so here they would be <code class="docutils literal notranslate"><span class="pre">plants</span></code> and <code class="docutils literal notranslate"><span class="pre">animals</span></code> layers. You need to define
the primary key of the referenced layers from the dropdown, so it is <code class="docutils literal notranslate"><span class="pre">fid</span></code>. Note that the definition of a
valid primary key requires all the referenced layers to have a field with that name. If there is no such field
you cannot save a polymorphic relation.</p></li>
</ul>
<p>Once added, the polymorphic relation can be edited via the <span class="guilabel">Edit Polymorphic Relation</span> menu entry.</p>
<figure class="align-center" id="id19">
<span id="figure-list-polymorphic-relations"></span><img alt="../../../_images/relations10.png" src="../../../_images/relations10.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.86 </span><span class="caption-text">Preview of the newly created polymorphic relation and it’s child relations for animals and plants.</span><a class="headerlink" href="#id19" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The example above uses the following database schema:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">SCHEMA</span> <span class="n">park</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">park</span><span class="p">.</span><span class="n">animals</span>
<span class="p">(</span>
   <span class="n">fid</span> <span class="nb">serial</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">geom</span> <span class="n">geometry</span><span class="p">(</span><span class="n">Point</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">animal_species</span> <span class="nb">text</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="k">CONSTRAINT</span> <span class="n">animals_pkey</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">fid</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">animals_geom_idx</span> <span class="k">ON</span> <span class="n">park</span><span class="p">.</span><span class="n">animals</span> <span class="k">USING</span> <span class="n">gist</span> <span class="p">(</span><span class="n">geom</span><span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">park</span><span class="p">.</span><span class="n">plants</span>
<span class="p">(</span>
   <span class="n">fid</span> <span class="nb">serial</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">geom</span> <span class="n">geometry</span><span class="p">(</span><span class="n">Point</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">plant_species</span> <span class="nb">text</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="k">CONSTRAINT</span> <span class="n">plants_pkey</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">fid</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">plants_geom_idx</span> <span class="k">ON</span> <span class="n">park</span><span class="p">.</span><span class="n">plants</span> <span class="k">USING</span> <span class="n">gist</span> <span class="p">(</span><span class="n">geom</span><span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">park</span><span class="p">.</span><span class="n">documents</span>
<span class="p">(</span>
   <span class="n">fid</span> <span class="nb">serial</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">referenced_layer</span> <span class="nb">text</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">referenced_fk</span> <span class="nb">integer</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="n">image_filename</span> <span class="nb">text</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="k">CONSTRAINT</span> <span class="n">documents_pkey</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">fid</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="storing-and-fetching-an-external-resource">
<span id="external-storage"></span><span id="index-12"></span><h2><a class="toc-backref" href="#id51"><span class="section-number">14.4.7. </span>Storing and fetching an external resource</a><a class="headerlink" href="#storing-and-fetching-an-external-resource" title="Permalink to this headline"></a></h2>
<p>A field may target a resource stored on an external storage system. Attribute forms can be configured
so they act as a client to an external storage system in order to store and fetch those resources, on
users demand, directly from the forms.</p>
<section id="configuring-an-external-storage">
<span id="external-storage-configuration"></span><h3><a class="toc-backref" href="#id52"><span class="section-number">14.4.7.1. </span>Configuring an external storage</a><a class="headerlink" href="#configuring-an-external-storage" title="Permalink to this headline"></a></h3>
<p>In order to setup an external storage, you have to first configure it from the vector
<a class="reference internal" href="vector_properties.html#edit-widgets"><span class="std std-ref">attribute form properties</span></a> and select the <span class="guilabel">Attachment</span> widget.</p>
<figure class="align-center" id="id20">
<span id="figure-external-storage-configuration"></span><img alt="../../../_images/external_storage_configuration.png" src="../../../_images/external_storage_configuration.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.87 </span><span class="caption-text">Editing a WebDAV external storage for a given field</span><a class="headerlink" href="#id20" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>From the <span class="guilabel">Attachment</span> widget, you have to first select the <span class="guilabel">Storage type</span>:</p>
<ul class="simple">
<li><p><span class="guilabel">Select Existing File</span>: The target URL already exists. When
you select a resource, no store operation is achieved, the attribute is simply updated with the URL.</p></li>
<li><p><span class="guilabel">Simple Copy</span>: Stores a copy of the resource on a file disk destination
(which could be a local or network shared file system) and the attribute is updated with the path to
the copy.</p></li>
<li><p><span class="guilabel">WebDAV Storage</span>: The resource is pushed to a HTTP server supporting the
<a class="reference external" href="https://en.wikipedia.org/wiki/WebDAV">WebDAV</a> protocol and the attribute is updated with
its URL. <a class="reference external" href="https://nextcloud.com/">Nextcloud</a>, <a class="reference external" href="https://pydio.com/">Pydio</a>
or other file hosting software support this protocol.</p></li>
</ul>
<p>Then, you have to set up the <span class="guilabel">Store URL</span> parameter, which provides the URL to be used when a new
resource needs to be stored. It’s possible to set up an expression using the
<a class="reference internal" href="../introduction/general_tools.html#data-defined"><span class="std std-ref">data defined override widget</span></a> in order to have specific values according to
feature attributes.</p>
<p>The variable <strong>&#64;selected_file_path</strong> could be used in that expression and represent the absolute
file path of the user selected file (using the file selector or drag’n drop).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using the <strong>WebDAV</strong> external storage, if the URL ends with a “/”, it is considered as a folder and
the selected file name will be appended to get the final URL.</p>
</div>
<p>If the external storage system needs to, it’s possible to configure an
<a class="reference internal" href="../introduction/general_tools.html#authentication"><span class="std std-ref">authentication</span></a>.</p>
</section>
<section id="using-an-external-storage">
<span id="external-storage-use"></span><h3><a class="toc-backref" href="#id53"><span class="section-number">14.4.7.2. </span>Using an external storage</a><a class="headerlink" href="#using-an-external-storage" title="Permalink to this headline"></a></h3>
<p>Once configured, you can select a local file using the button <span class="guilabel">…</span> when editing a feature’s attribute.
Depending on the configured <a class="reference internal" href="#external-storage-configuration"><span class="std std-ref">storage type</span></a>, the file
will be stored on the external storage system (except if <span class="guilabel">Select existing file</span> has been
selected) and the field will be updated with the new resource URL.</p>
<figure class="align-center" id="id21">
<span id="figure-external-storage-store"></span><img alt="../../../_images/external_storage_store.png" src="../../../_images/external_storage_store.png" />
<figcaption>
<p><span class="caption-number">Fig. 14.88 </span><span class="caption-text">Storing a file to a WebDAV external storage</span><a class="headerlink" href="#id21" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>User can also achieve the same result if he drags and drops a file on the whole attachment
widget.</p>
</div>
<p>Use the <a class="reference internal" href="../../../_images/mTaskCancel.png"><img alt="cancel" src="../../../_images/mTaskCancel.png" style="width: 1.5em;" /></a> <sup>Cancel</sup> button to abort the storing process.
It’s possible to configure a viewer using the <span class="guilabel">Integrated document viewer</span>
so the resource will be automatically fetched from the external storage system and
displayed directly below the URL.
The above <a class="reference internal" href="../../../_images/mIconWarning.png"><img alt="warning" src="../../../_images/mIconWarning.png" style="width: 1.5em;" /></a> icon indicates that the resource cannot be fetched
from the external storage system. In that case, more details might appear in the
<a class="reference internal" href="../introduction/general_tools.html#log-message-panel"><span class="std std-ref">Log Messages Panel</span></a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="functions_list.html" class="btn btn-neutral float-left" title="14.3. List of functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="editing_geometry_attributes.html" class="btn btn-neutral float-right" title="14.5. Editing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2002-now, QGIS project.
      <span class="lastupdated">Last updated on Oct 19, 2021 22:25.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <!-- Transifex follows a particular logic to build target pages
example of expected format: .../locale-en-lc-messages-docs-gentle-gis-introduction-data-capture-po--release-3-16 
for the page ...3.16/docs/gentle_gis_introduction/data_capture.html in release_3.16 branch-->
<!--Make sure that mismatching languages codes are converted-->


  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-info-circle"> QGIS Documentation </span>
      v: testing
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
      <dl>
        <dt>Languages</dt>
        
          <dd><a href="https://docs.qgis.org/testing/en/docs/user_manual/working_with_vector/attribute_table.html">en</a></dd>
        
      </dl>

      <dl>
        <dt>Versions</dt>
        
          <dd><a href="https://docs.qgis.org/testing/en/docs/user_manual/working_with_vector/attribute_table.html">testing</a></dd>
        
          <dd><a href="https://docs.qgis.org/latest/en/docs/user_manual/working_with_vector/attribute_table.html">latest</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.16/en/docs/user_manual/working_with_vector/attribute_table.html">3.16</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.10/en/docs/user_manual/working_with_vector/attribute_table.html">3.10</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.4/en/docs/user_manual/working_with_vector/attribute_table.html">3.4</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.18/en/docs/user_manual/working_with_vector/attribute_table.html">2.18</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.14/en/docs/user_manual/working_with_vector/attribute_table.html">2.14</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.8/en/docs/user_manual/working_with_vector/attribute_table.html">2.8</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.6/en/docs/user_manual/working_with_vector/attribute_table.html">2.6</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.2/en/docs/user_manual/working_with_vector/attribute_table.html">2.2</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.0/en/docs/user_manual/working_with_vector/attribute_table.html">2.0</a></dd>
        
          <dd><a href="https://docs.qgis.org/1.8/en/docs/user_manual/working_with_vector/attribute_table.html">1.8</a></dd>
        
      </dl>

       
       <dl>
        <dt>Downloads</dt>
        
          <dd><a href="https://docs.qgis.org/testing/pdf">PDF</a></dd>
        
          <dd><a href="https://docs.qgis.org/testing/zip">HTML</a></dd>
        
      </dl>
      

      
       
      <dl>
        <dt>Contribute to Docs</dt>
          <dd>
            <a href="https://github.com/qgis/QGIS-Documentation/edit/master/docs/user_manual/working_with_vector/attribute_table.rst" target="_blank" rel="noopener noreferrer">Edit on GitHub</a>
          </dd>
          
          
          <dd>
            <a href="https://github.com/qgis/QGIS-Documentation/issues" target="_blank" rel="noopener noreferrer">Report Issue</a>
          </dd>
      </dl>
      

      <dl>
        <dt>On QGIS Project</dt>
          <dd>
            <a href="https://qgis.org/en" target="_blank" rel="noopener noreferrer">Home</a>
          </dd>
          <dd>
            <a href="https://qgis.org/api/" target="_blank" rel="noopener noreferrer">C++ API</a>
          </dd>
          <dd>
            <a href="https://qgis.org/pyqgis/master" target="_blank" rel="noopener noreferrer">PyQGIS API</a>
          </dd>
          <dd>
            <a href="https://github.com/qgis/QGIS/tree/master" target="_blank" rel="noopener noreferrer">Source</a>
          </dd>
      </dl>

    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>